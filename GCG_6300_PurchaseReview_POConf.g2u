Program.Sub.ScreenSU.Start
Gui.FrmPO..Create(BaseForm)
Gui.FrmPO..Size(1020,715)
Gui.FrmPO..MinX(1016)
Gui.FrmPO..MinY(706)
Gui.FrmPO..Position(0,0)
Gui.FrmPO..BackColor(-2147483633)
Gui.FrmPO..MousePointer(0)
Gui.FrmPO..Event(UnLoad,FrmPO_UnLoad)
Gui.FrmPO..Caption("Purchase Order Gridview (6300)")
Gui.FrmPO..AlwaysOnTop(False)
Gui.FrmPO..FontName("Tahoma")
Gui.FrmPO..FontSize(8.25)
Gui.FrmPO..ControlBox(True)
Gui.FrmPO..MaxButton(True)
Gui.FrmPO..MinButton(True)
Gui.FrmPO..Moveable(True)
Gui.FrmPO..Sizeable(True)
Gui.FrmPO..ShowInTaskBar(True)
Gui.FrmPO..TitleBar(True)
Gui.FrmPO.tabPODash.Create(Tab)
Gui.FrmPO.tabPODash.Size(1008,601)
Gui.FrmPO.tabPODash.Position(1,75)
Gui.FrmPO.tabPODash.Event(Click,tabPODash_Click)
Gui.FrmPO.tabPODash.Enabled(True)
Gui.FrmPO.tabPODash.Visible(True)
Gui.FrmPO.tabPODash.Zorder(0)
Gui.FrmPO.tabPODash.FontName("Tahoma")
Gui.FrmPO.tabPODash.FontSize(8.25)
Gui.FrmPO.tabPODash.Tabs(5)
Gui.FrmPO.tabPODash.SetTab(0)
Gui.FrmPO.tabPODash.Caption("Open POs")
Gui.FrmPO.tabPODash.SetTab(1)
Gui.FrmPO.tabPODash.Caption("Expected Today")
Gui.FrmPO.tabPODash.SetTab(2)
Gui.FrmPO.tabPODash.Caption("Past Due")
Gui.FrmPO.tabPODash.SetTab(3)
Gui.FrmPO.tabPODash.Caption("Outside Service Request")
Gui.FrmPO.tabPODash.SetTab(4)
Gui.FrmPO.tabPODash.Caption("Requisitions")
Gui.FrmPO.GsGcReqs.Create(GsGridControl)
Gui.FrmPO.GsGcReqs.Size(1006,572)
Gui.FrmPO.GsGcReqs.Position(0,0)
Gui.FrmPO.GsGcReqs.Parent("tabPODash",4)
Gui.FrmPO.GsGcReqs.Enabled(True)
Gui.FrmPO.GsGcReqs.Visible(True)
Gui.FrmPO.GsGcReqs.Zorder(0)
Gui.FrmPO.GsGcReqs.Dock(5)
Gui.FrmPO.GsGCOSV.Create(GsGridControl)
Gui.FrmPO.GsGCOSV.Size(1006,572)
Gui.FrmPO.GsGCOSV.Position(0,0)
Gui.FrmPO.GsGCOSV.Parent("tabPODash",3)
Gui.FrmPO.GsGCOSV.Event(RowCellClick,GsGCOSV_RowCellClick)
Gui.FrmPO.GsGCOSV.Enabled(True)
Gui.FrmPO.GsGCOSV.Visible(True)
Gui.FrmPO.GsGCOSV.Zorder(0)
Gui.FrmPO.GsGCOSV.Dock(5)
Gui.FrmPO.GsGCAllPOs.Create(GsGridControl)
Gui.FrmPO.GsGCAllPOs.Size(1006,572)
Gui.FrmPO.GsGCAllPOs.Position(0,0)
Gui.FrmPO.GsGCAllPOs.Parent("tabPODash",0)
Gui.FrmPO.GsGCAllPOs.Event(RowCellClick,GsGCAllPOs_RowCellClick)
Gui.FrmPO.GsGCAllPOs.Event(CellValueChanged,GsGCAllPOs_CellValueChanged)
Gui.FrmPO.GsGCAllPOs.Enabled(True)
Gui.FrmPO.GsGCAllPOs.Visible(True)
Gui.FrmPO.GsGCAllPOs.Zorder(0)
Gui.FrmPO.GsGCAllPOs.Dock(5)
Gui.FrmPO.GsGCExpToday.Create(GsGridControl)
Gui.FrmPO.GsGCExpToday.Size(1006,572)
Gui.FrmPO.GsGCExpToday.Position(0,0)
Gui.FrmPO.GsGCExpToday.Parent("tabPODash",1)
Gui.FrmPO.GsGCExpToday.Event(RowCellClick,GsGCExpToday_RowCellClick)
Gui.FrmPO.GsGCExpToday.Event(CellValueChanged,GsGCExpToday_CellValueChanged)
Gui.FrmPO.GsGCExpToday.Enabled(True)
Gui.FrmPO.GsGCExpToday.Visible(True)
Gui.FrmPO.GsGCExpToday.Zorder(0)
Gui.FrmPO.GsGCExpToday.Dock(5)
Gui.FrmPO.GsGCPastDue.Create(GsGridControl)
Gui.FrmPO.GsGCPastDue.Size(1006,572)
Gui.FrmPO.GsGCPastDue.Position(0,0)
Gui.FrmPO.GsGCPastDue.Parent("tabPODash",2)
Gui.FrmPO.GsGCPastDue.Event(RowCellClick,GsGCPastDue_RowCellClick)
Gui.FrmPO.GsGCPastDue.Event(CellValueChanged,GsGCPastDue_CellValueChanged)
Gui.FrmPO.GsGCPastDue.Enabled(True)
Gui.FrmPO.GsGCPastDue.Visible(True)
Gui.FrmPO.GsGCPastDue.Zorder(0)
Gui.FrmPO.GsGCPastDue.Dock(5)
Gui.FrmPO.progressBar1.Create(ProgressBar)
Gui.FrmPO.progressBar1.Visible(False)
Gui.FrmPO.progressBar1.Size(139,17)
Gui.FrmPO.progressBar1.Position(5,24)
Gui.FrmPO.lbl1.Create(Label,"***Change***",False,139,17,0,5,8,True,0,"Arial",8,-2147483633,0,0)
Gui.FrmPO.lbl1.BorderStyle(0)
Gui.FrmPO.picGSSLogo.Create(PictureBox)
Gui.FrmPO.picGSSLogo.Size(275,64)
Gui.FrmPO.picGSSLogo.Position(368,3)
Gui.FrmPO.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.FrmPO.picGSSLogo.ToolTip("Double-Click for additional functions")
Gui.FrmPO.picGSSLogo.Enabled(True)
Gui.FrmPO.picGSSLogo.Visible(True)
Gui.FrmPO.picGSSLogo.Zorder(0)
Gui.FrmPO.framePermissions.Create(Frame)
Gui.FrmPO.framePermissions.Size(161,28)
Gui.FrmPO.framePermissions.Position(842,4)
Gui.FrmPO.framePermissions.Enabled(True)
Gui.FrmPO.framePermissions.Visible(True)
Gui.FrmPO.framePermissions.Zorder(0)
Gui.FrmPO.framePermissions.Caption("")
Gui.FrmPO.framePermissions.FontName("Tahoma")
Gui.FrmPO.framePermissions.FontSize(8.25)
Gui.FrmPO.optView.Create(Option)
Gui.FrmPO.optView.Caption("View")
Gui.FrmPO.optView.Event(Click,optView_Click)
Gui.FrmPO.optView.Parent("framePermissions")
Gui.FrmPO.optView.Size(50,15)
Gui.FrmPO.optView.Position(3,8)
Gui.FrmPO.optView.Enabled(True)
Gui.FrmPO.optView.Visible(True)
Gui.FrmPO.optView.Zorder(0)
Gui.FrmPO.optView.FontName("Tahoma")
Gui.FrmPO.optView.FontSize(8.25)
Gui.FrmPO.optRecV.Create(Option)
Gui.FrmPO.optRecV.Enabled(False)
Gui.FrmPO.optRecV.Caption("Receive")
Gui.FrmPO.optRecV.BackColor(15790320)
Gui.FrmPO.optRecV.ForeColor(0)
Gui.FrmPO.optRecV.Event(Click,optRecv_Click)
Gui.FrmPO.optRecV.Parent("framePermissions")
Gui.FrmPO.optRecV.Size(63,16)
Gui.FrmPO.optRecV.Position(96,8)
Gui.FrmPO.optRecV.Visible(True)
Gui.FrmPO.optRecV.Zorder(0)
Gui.FrmPO.optRecV.FontName("Tahoma")
Gui.FrmPO.optRecV.FontSize(8.25)
Gui.FrmPO.optEdit.Create(Option)
Gui.FrmPO.optEdit.Caption("Edit")
Gui.FrmPO.optEdit.Enabled(False)
Gui.FrmPO.optEdit.Event(Click,optEdit_Click)
Gui.FrmPO.optEdit.Parent("framePermissions")
Gui.FrmPO.optEdit.Size(43,18)
Gui.FrmPO.optEdit.Position(53,8)
Gui.FrmPO.optEdit.Visible(True)
Gui.FrmPO.optEdit.Zorder(0)
Gui.FrmPO.optEdit.FontName("Tahoma")
Gui.FrmPO.optEdit.FontSize(8.25)
Gui.FrmPO.cmdEmail.Create(Button)
Gui.FrmPO.cmdEmail.Size(73,22)
Gui.FrmPO.cmdEmail.Position(936,76)
Gui.FrmPO.cmdEmail.Anchor(9)
Gui.FrmPO.cmdEmail.Caption("Send Emails")
Gui.FrmPO.cmdEmail.Event(Click,cmdEmail_Click)
Gui.FrmPO.cmdEmail.Enabled(True)
Gui.FrmPO.cmdEmail.Visible(True)
Gui.FrmPO.cmdEmail.Zorder(0)
Gui.FrmPO.cmdEmail.FontName("Tahoma")
Gui.FrmPO.cmdEmail.FontSize(8.25)
Gui.FrmPO.txtLate.Create(TextBox,"Late",True,36,20,0,870,33,True,2,"Arial",8,13353215,1)
Gui.FrmPO.txtLate.Anchor(9)
Gui.FrmPO.txtLate.Locked(True)
Gui.FrmPO.txtLate.ToolTip("Past PO Due Date")
Gui.FrmPO.txtInsp.Create(TextBox,"Needs Inspection",True,94,20,0,909,33,True,2,"Arial",8,55295,1)
Gui.FrmPO.txtInsp.Anchor(9)
Gui.FrmPO.txtInsp.Locked(True)
Gui.FrmPO.txtInsp.ToolTip("Part is flagged for inspection")
Gui.FrmPO.chkPrevEmls.Create(CheckBox)
Gui.FrmPO.chkPrevEmls.Size(99,20)
Gui.FrmPO.chkPrevEmls.Position(911,55)
Gui.FrmPO.chkPrevEmls.Caption("Preview Emails")
Gui.FrmPO.chkPrevEmls.Event(Click,chkPrevEmls_Click)
Gui.FrmPO.chkPrevEmls.Anchor(9)
Gui.FrmPO.chkPrevEmls.Enabled(True)
Gui.FrmPO.chkPrevEmls.Visible(True)
Gui.FrmPO.chkPrevEmls.Zorder(0)
Gui.FrmPO.chkPrevEmls.FontName("Tahoma")
Gui.FrmPO.chkPrevEmls.FontSize(8.25)
Gui.frmNewPO..Create(BaseForm)
Gui.frmNewPO..Caption("New PO")
Gui.frmNewPO..Size(164,95)
Gui.frmNewPO..MinX(164)
Gui.frmNewPO..MinY(80)
Gui.frmNewPO..Position(0,0)
Gui.frmNewPO..BackColor(-2147483633)
Gui.frmNewPO..MaxButton(False)
Gui.frmNewPO..MinButton(False)
Gui.frmNewPO..MousePointer(0)
Gui.frmNewPO..Sizeable(False)
Gui.frmNewPO..Event(UnLoad,frmNewPO_UnLoad)
Gui.frmNewPO..AlwaysOnTop(False)
Gui.frmNewPO..FontName("Tahoma")
Gui.frmNewPO..FontSize(8.25)
Gui.frmNewPO..ControlBox(True)
Gui.frmNewPO..Moveable(True)
Gui.frmNewPO..ShowInTaskBar(True)
Gui.frmNewPO..TitleBar(True)
Gui.frmNewPO.cmdManualPO.Create(Button)
Gui.frmNewPO.cmdManualPO.Size(145,25)
Gui.frmNewPO.cmdManualPO.Position(6,4)
Gui.frmNewPO.cmdManualPO.Caption("Purchase Orders (Manual)")
Gui.frmNewPO.cmdManualPO.Event(Click,cmdManualPO_Click)
Gui.frmNewPO.cmdManualPO.Enabled(True)
Gui.frmNewPO.cmdManualPO.Visible(True)
Gui.frmNewPO.cmdManualPO.Zorder(0)
Gui.frmNewPO.cmdManualPO.FontName("Tahoma")
Gui.frmNewPO.cmdManualPO.FontSize(8.25)
Gui.frmNewPO.cmdAutoPO.Create(Button)
Gui.frmNewPO.cmdAutoPO.Size(145,25)
Gui.frmNewPO.cmdAutoPO.Position(6,32)
Gui.frmNewPO.cmdAutoPO.Caption("Automated Purchasing")
Gui.frmNewPO.cmdAutoPO.Event(Click,cmdAutoPO_Click)
Gui.frmNewPO.cmdAutoPO.Enabled(True)
Gui.frmNewPO.cmdAutoPO.Visible(True)
Gui.frmNewPO.cmdAutoPO.Zorder(0)
Gui.frmNewPO.cmdAutoPO.FontName("Tahoma")
Gui.frmNewPO.cmdAutoPO.FontSize(8.25)
Gui.frmPrevEmail..Create(BaseForm)
Gui.frmPrevEmail..Caption("PO - Preview Emails")
Gui.frmPrevEmail..Size(985,390)
Gui.frmPrevEmail..MinX(988)
Gui.frmPrevEmail..MinY(375)
Gui.frmPrevEmail..Position(0,0)
Gui.frmPrevEmail..BackColor(-2147483633)
Gui.frmPrevEmail..MousePointer(0)
Gui.frmPrevEmail..Event(UnLoad,frmPrevEmail_UnLoad)
Gui.frmPrevEmail..AlwaysOnTop(False)
Gui.frmPrevEmail..FontName("Tahoma")
Gui.frmPrevEmail..FontSize(8.25)
Gui.frmPrevEmail..ControlBox(True)
Gui.frmPrevEmail..MaxButton(True)
Gui.frmPrevEmail..MinButton(True)
Gui.frmPrevEmail..Moveable(True)
Gui.frmPrevEmail..Sizeable(True)
Gui.frmPrevEmail..ShowInTaskBar(True)
Gui.frmPrevEmail..TitleBar(True)
Gui.frmPrevEmail.GsGCPrevEml.Create(GsGridControl)
Gui.frmPrevEmail.GsGCPrevEml.Size(977,327)
Gui.frmPrevEmail.GsGCPrevEml.Position(1,1)
Gui.frmPrevEmail.GsGCPrevEml.Event(RowCellClick,GsGCPrevEml_RowCellClick)
Gui.frmPrevEmail.GsGCPrevEml.Enabled(True)
Gui.frmPrevEmail.GsGCPrevEml.Visible(True)
Gui.frmPrevEmail.GsGCPrevEml.Zorder(0)
Gui.frmPrevEmail.cmdSend.Create(Button)
Gui.frmPrevEmail.cmdSend.Size(75,25)
Gui.frmPrevEmail.cmdSend.Position(903,329)
Gui.frmPrevEmail.cmdSend.Caption("Send Emails")
Gui.frmPrevEmail.cmdSend.Event(Click,cmdSend_Click)
Gui.frmPrevEmail.cmdSend.Enabled(True)
Gui.frmPrevEmail.cmdSend.Visible(True)
Gui.frmPrevEmail.cmdSend.Zorder(0)
Gui.frmPrevEmail.cmdSend.FontName("Tahoma")
Gui.frmPrevEmail.cmdSend.FontSize(8.25)
Gui.frmPrevEmail.lblStatus.Create(Label,"Sending Emails....",False,109,17,0,1,334,True,0,"Arial",8,-2147483633,0,0)
Gui.frmPrevEmail.lblStatus.BorderStyle(0)
Gui.frmPrevEmail.pbStatus.Create(ProgressBar)
Gui.frmPrevEmail.pbStatus.Size(165,17)
Gui.frmPrevEmail.pbStatus.Position(111,330)
Gui.frmPrevEmail.pbStatus.Visible(False)
Gui.frmEmail..Create(BaseForm)
Gui.frmEmail..Size(476,575)
Gui.frmEmail..MinX(484)
Gui.frmEmail..MinY(470)
Gui.frmEmail..Position(0,0)
Gui.frmEmail..BackColor(-2147483633)
Gui.frmEmail..MousePointer(0)
Gui.frmEmail..Event(UnLoad,frmEmail_UnLoad)
Gui.frmEmail..Caption("Edit Email")
Gui.frmEmail..MaxButton(False)
Gui.frmEmail..Sizeable(False)
Gui.frmEmail..AlwaysOnTop(False)
Gui.frmEmail..FontName("Tahoma")
Gui.frmEmail..FontSize(8.25)
Gui.frmEmail..ControlBox(True)
Gui.frmEmail..MinButton(True)
Gui.frmEmail..Moveable(True)
Gui.frmEmail..ShowInTaskBar(True)
Gui.frmEmail..TitleBar(True)
Gui.frmEmail.txtBody.Create(TextboxM)
Gui.frmEmail.txtBody.Size(461,254)
Gui.frmEmail.txtBody.Position(5,154)
Gui.frmEmail.txtBody.Enabled(True)
Gui.frmEmail.txtBody.Visible(True)
Gui.frmEmail.txtBody.Zorder(0)
Gui.frmEmail.txtBody.FontName("Tahoma")
Gui.frmEmail.txtBody.FontSize(8.25)
Gui.frmEmail.txtSubject.Create(TextboxM)
Gui.frmEmail.txtSubject.Size(461,20)
Gui.frmEmail.txtSubject.Position(5,111)
Gui.frmEmail.txtSubject.Enabled(True)
Gui.frmEmail.txtSubject.Visible(True)
Gui.frmEmail.txtSubject.Zorder(0)
Gui.frmEmail.txtSubject.FontName("Tahoma")
Gui.frmEmail.txtSubject.FontSize(8.25)
Gui.frmEmail.lblBody.Create(Label,"Body:",True,44,17,0,5,139,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblBody.BorderStyle(0)
Gui.frmEmail.lblSubject.Create(Label,"Subject:",True,51,17,0,5,96,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblSubject.BorderStyle(0)
Gui.frmEmail.txtSName.Create(TextBox,"",True,225,20,0,5,24,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtSName.MaxLength(30)
Gui.frmEmail.txtRName.Create(TextBox,"",True,225,20,0,5,65,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtRName.MaxLength(30)
Gui.frmEmail.txtSEmail.Create(TextBox,"",True,225,20,0,238,24,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtSEmail.MaxLength(100)
Gui.frmEmail.txtREmail.Create(TextBox,"",True,225,20,0,238,65,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtREmail.MaxLength(100)
Gui.frmEmail.lblSName.Create(Label,"Sender Name:",True,80,14,0,3,9,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblSName.BorderStyle(0)
Gui.frmEmail.lblSEmail.Create(Label,"Sender Email:",True,80,14,0,236,9,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblSEmail.BorderStyle(0)
Gui.frmEmail.lblREmail.Create(Label,"Recipient Email:",True,87,14,0,236,50,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblREmail.BorderStyle(0)
Gui.frmEmail.lblRName.Create(Label,"Recipient Name:",True,90,14,0,3,50,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblRName.BorderStyle(0)
Gui.frmEmail.cmdSave.Create(Button)
Gui.frmEmail.cmdSave.Size(57,22)
Gui.frmEmail.cmdSave.Position(5,520)
Gui.frmEmail.cmdSave.Caption("Save")
Gui.frmEmail.cmdSave.Event(Click,cmdSavePreview_Click)
Gui.frmEmail.cmdSave.Enabled(True)
Gui.frmEmail.cmdSave.Visible(True)
Gui.frmEmail.cmdSave.Zorder(0)
Gui.frmEmail.cmdSave.FontName("Tahoma")
Gui.frmEmail.cmdSave.FontSize(8.25)
Gui.frmEmail.txtRow.Create(TextBox,"",False,22,20,0,444,521,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtAttach.Create(TextboxM)
Gui.frmEmail.txtAttach.Size(461,86)
Gui.frmEmail.txtAttach.Position(5,431)
Gui.frmEmail.txtAttach.Enabled(True)
Gui.frmEmail.txtAttach.Visible(True)
Gui.frmEmail.txtAttach.Zorder(0)
Gui.frmEmail.txtAttach.FontName("Tahoma")
Gui.frmEmail.txtAttach.FontSize(8.25)
Gui.frmEmail.lblActtach.Create(Label,"Attachment(s):",True,79,17,0,5,416,True,0,"Arial",8,-2147483633,0,0)
Gui.frmEmail.lblActtach.BorderStyle(0)
Gui.frmEmail.txtDropFiles.Create(TextBox,"Drop Files Here",True,95,20,0,85,410,True,2,"Arial",8,11119017,1)
Gui.frmEmail.txtDropFiles.FontStyle(True,False,False,False,False)
Gui.frmEmail.txtDropFiles.Locked(True)
Gui.fmImpact..Create(BaseForm)
Gui.fmImpact..Caption("Impact")
Gui.fmImpact..Size(1197,424)
Gui.fmImpact..MinX(0)
Gui.fmImpact..MinY(0)
Gui.fmImpact..Position(0,0)
Gui.fmImpact..AlwaysOnTop(False)
Gui.fmImpact..FontName("Tahoma")
Gui.fmImpact..FontSize(8.25)
Gui.fmImpact..ControlBox(True)
Gui.fmImpact..MaxButton(True)
Gui.fmImpact..MinButton(True)
Gui.fmImpact..MousePointer(0)
Gui.fmImpact..Moveable(True)
Gui.fmImpact..Sizeable(True)
Gui.fmImpact..ShowInTaskBar(True)
Gui.fmImpact..TitleBar(True)
Gui.fmImpact..Event(UnLoad,fmImpact_UnLoad)
Gui.fmImpact.lblPO.Create(Label,"PO #:",True,52,19,0,6,4,True,0,"Tahoma",12,,0,1)
Gui.fmImpact.lblPO.BorderStyle(0)
Gui.fmImpact.lblPO.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblPO.ForeColor(11829830)
Gui.fmImpact.lblPONum.Create(Label,"Label",True,44,19,0,63,4,True,0,"Tahoma",12,,0,0)
Gui.fmImpact.lblPONum.BorderStyle(0)
Gui.fmImpact.lblPONum.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblImpReason.Create(Label,"Impact Reason",True,97,16,0,6,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblImpReason.BorderStyle(0)
Gui.fmImpact.lblImpReason.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblImpReason.ForeColor(11829830)
Gui.fmImpact.lblDImpOwn.Create(Label,"Dept Impact Owner",True,126,16,0,162,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblDImpOwn.BorderStyle(0)
Gui.fmImpact.lblDImpOwn.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblDImpOwn.ForeColor(11829830)
Gui.fmImpact.lblUImpOwn.Create(Label,"User Impact Owner",True,124,16,0,319,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblUImpOwn.BorderStyle(0)
Gui.fmImpact.lblUImpOwn.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblUImpOwn.ForeColor(11829830)
Gui.fmImpact.lblImpact.Create(Label,"Impact",True,45,16,0,457,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblImpact.BorderStyle(0)
Gui.fmImpact.lblImpact.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblImpact.ForeColor(11829830)
Gui.fmImpact.lblNextStep.Create(Label,"Next Step",True,63,16,0,670,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblNextStep.BorderStyle(0)
Gui.fmImpact.lblNextStep.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblNextStep.ForeColor(11829830)
Gui.fmImpact.lblRes.Create(Label,"Resolution",True,68,16,0,882,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblRes.BorderStyle(0)
Gui.fmImpact.lblRes.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblRes.ForeColor(11829830)
Gui.fmImpact.lblClsDate.Create(Label,"Date Closed",True,77,16,0,1092,33,True,0,"Tahoma",10,,0,0)
Gui.fmImpact.lblClsDate.BorderStyle(0)
Gui.fmImpact.lblClsDate.FontStyle(True,False,False,False,False)
Gui.fmImpact.lblClsDate.ForeColor(11829830)
Gui.fmImpact.ddlImpReason.Create(DropDownList)
Gui.fmImpact.ddlImpReason.Enabled(True)
Gui.fmImpact.ddlImpReason.Visible(True)
Gui.fmImpact.ddlImpReason.Zorder(0)
Gui.fmImpact.ddlImpReason.Size(120,20)
Gui.fmImpact.ddlImpReason.Position(6,50)
Gui.fmImpact.ddlImpReason.FontName("Tahoma")
Gui.fmImpact.ddlImpReason.FontSize(8.25)
Gui.fmImpact.ddlDImpOwn.Create(DropDownList)
Gui.fmImpact.ddlDImpOwn.Enabled(True)
Gui.fmImpact.ddlDImpOwn.Visible(True)
Gui.fmImpact.ddlDImpOwn.Zorder(0)
Gui.fmImpact.ddlDImpOwn.Size(129,20)
Gui.fmImpact.ddlDImpOwn.Position(161,50)
Gui.fmImpact.ddlDImpOwn.FontName("Tahoma")
Gui.fmImpact.ddlDImpOwn.FontSize(8.25)
Gui.fmImpact.ddlUImpOwn.Create(DropDownList)
Gui.fmImpact.ddlUImpOwn.Enabled(True)
Gui.fmImpact.ddlUImpOwn.Visible(True)
Gui.fmImpact.ddlUImpOwn.Zorder(0)
Gui.fmImpact.ddlUImpOwn.Size(119,20)
Gui.fmImpact.ddlUImpOwn.Position(319,50)
Gui.fmImpact.ddlUImpOwn.FontName("Tahoma")
Gui.fmImpact.ddlUImpOwn.FontSize(8.25)
Gui.fmImpact.txtImpact.Create(TextboxM)
Gui.fmImpact.txtImpact.Enabled(True)
Gui.fmImpact.txtImpact.Visible(True)
Gui.fmImpact.txtImpact.Zorder(0)
Gui.fmImpact.txtImpact.Size(204,96)
Gui.fmImpact.txtImpact.Position(457,50)
Gui.fmImpact.txtImpact.FontName("Tahoma")
Gui.fmImpact.txtImpact.FontSize(8.25)
Gui.fmImpact.txtNextStep.Create(TextboxM)
Gui.fmImpact.txtNextStep.Enabled(True)
Gui.fmImpact.txtNextStep.Visible(True)
Gui.fmImpact.txtNextStep.Zorder(0)
Gui.fmImpact.txtNextStep.Size(204,96)
Gui.fmImpact.txtNextStep.Position(670,50)
Gui.fmImpact.txtNextStep.FontName("Tahoma")
Gui.fmImpact.txtNextStep.FontSize(8.25)
Gui.fmImpact.txtRes.Create(TextboxM)
Gui.fmImpact.txtRes.Enabled(True)
Gui.fmImpact.txtRes.Visible(True)
Gui.fmImpact.txtRes.Zorder(0)
Gui.fmImpact.txtRes.Size(204,96)
Gui.fmImpact.txtRes.Position(882,50)
Gui.fmImpact.txtRes.FontName("Tahoma")
Gui.fmImpact.txtRes.FontSize(8.25)
Gui.fmImpact.dtpClsDate.Create(DatePicker)
Gui.fmImpact.dtpClsDate.Enabled(True)
Gui.fmImpact.dtpClsDate.Visible(True)
Gui.fmImpact.dtpClsDate.Zorder(0)
Gui.fmImpact.dtpClsDate.Size(100,20)
Gui.fmImpact.dtpClsDate.Position(1092,50)
Gui.fmImpact.dtpClsDate.CheckBox(False)
Gui.fmImpact.dtpClsDate.FontName("Tahoma")
Gui.fmImpact.dtpClsDate.FontSize(8.25)
Gui.fmImpact.dtpClsDate.Value(1/1/1900 12:00:00 AM)
Gui.fmImpact.cmdSV.Create(Button)
Gui.fmImpact.cmdSV.Enabled(True)
Gui.fmImpact.cmdSV.Visible(True)
Gui.fmImpact.cmdSV.Zorder(0)
Gui.fmImpact.cmdSV.Size(75,23)
Gui.fmImpact.cmdSV.Position(1104,80)
Gui.fmImpact.cmdSV.Caption("SAVE")
Gui.fmImpact.cmdSV.FontName("Tahoma")
Gui.fmImpact.cmdSV.FontSize(8.25)
Gui.fmImpact.cmdSV.FontStyle(True,False,False,False,False)
Gui.fmImpact.cmdSV.BackColor(11119017)
Gui.fmImpact.cmdSV.ForeColor(0)
Gui.fmImpact.cmdSV.Event(Click,cmdSv_Click)
Gui.fmImpact.GsGcImpact.Create(GsGridControl)
Gui.fmImpact.GsGcImpact.Enabled(True)
Gui.fmImpact.GsGcImpact.Visible(True)
Gui.fmImpact.GsGcImpact.Zorder(0)
Gui.fmImpact.GsGcImpact.Size(1186,238)
Gui.fmImpact.GsGcImpact.Position(6,150)
Gui.fmImpact.GsGcImpact.Event(RowCellClick,GsGcImpact_RowCellClick)
Gui.fmImpact.GsGcImpact.Anchor(15)
Gui.fmImpact.txtRecord.Create(TextBox,"",False,100,20,0,6,79,True,0,"Tahoma",8.25,,1)
Gui.fmImpact.cmdClr.Create(Button)
Gui.fmImpact.cmdClr.Enabled(True)
Gui.fmImpact.cmdClr.Visible(True)
Gui.fmImpact.cmdClr.Zorder(0)
Gui.fmImpact.cmdClr.Size(75,23)
Gui.fmImpact.cmdClr.Position(1104,109)
Gui.fmImpact.cmdClr.Caption("Clear")
Gui.fmImpact.cmdClr.FontName("Tahoma")
Gui.fmImpact.cmdClr.FontSize(8.25)
Gui.fmImpact.cmdClr.BackColor(11119017)
Gui.fmImpact.cmdClr.FontStyle(True,False,False,False,False)
Gui.fmImpact.cmdClr.ForeColor(0)
Gui.fmImpact.cmdClr.Event(Click,cmdClr_Click)
Gui.fmImpact.txtCtrlName.Create(TextBox,"",False,1500,300,0,1695,1185,True,0,"Tahoma",8.25,,1)
Gui.fmImpact.txtRowIndex.Create(TextBox,"",False,1500,300,0,3300,1185,True,0,"Tahoma",8.25,,1)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.bLoadData.Declare
	V.Global.bLongPart.Declare
	
	V.Global.bViewPO.Declare
	V.Global.bEditPO.Declare
	V.Global.bPOReceipt.Declare
	V.Global.bPOReceiptShipping.Declare
	V.Global.bViewPart.Declare
	V.Global.bEditPart.Declare
	V.Global.bOutsidePO.Declare
	V.Global.iDoNotPrintAudit.Declare
	Program.External.Include.Library("PPT_Canny.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	
	Function.Intrinsic.UI.UsePixels ' Allows you to use Pixels instead of Twips throughout
'TJS, Mar 2021
'Thomas Instruments
'Quote 12711
'Business Case: The customer is needing a way to capture specific information on their dashboards relating to an Impact Issue and Specific Next Step [Internal Notes].
'Modified from PPT_PU_PurchaseReview_POConF.g2u
	V.Local.sError.Declare
	
	V.Local.sIcon.Declare
	V.Local.bEditGrp.Declare
	V.Local.sGssLogo.Declare	

	F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,V.Local.sIcon)		
	F.Intrinsic.String.Build("{0}\ART\GAB_GSS_Logo_Green_Dash.png",V.Caller.GlobalDir,V.Local.sGssLogo)		
	Gui.frmNewPO..Icon(V.Local.sIcon)
	Gui.FrmPO..Icon(V.Local.sIcon)
	Gui.frmEmail..Icon(V.Local.sIcon)
	Gui.frmPrevEmail..Icon(V.Local.sIcon)
	Gui.FrmPO.picGSSLogo.Picture(V.Local.sGssLogo)
	Gui.frmEmail.txtDropFiles.Event("DRAGDROPFILE",Dragdrop)
	
	'Canny
	F.Intrinsic.Control.CallSub(CannyCheckUser,"Form","FrmPO")

	Gui.FrmPO.tabPODash.SetTab(0)

	F.Intrinsic.Control.CallSub(SetAnchors)
	F.Intrinsic.Control.CallSub(CheckLongPart)			
	'F.Intrinsic.Control.CallSub(CheckPrevEmail)
	
	'Check Print Audit Option		
	F.Global.General.ReadOption(402520,0,0000,V.Global.iDoNotPrintAudit)

	'Check if the User has permission to view, edit or receive POs
	F.Intrinsic.Control.CallSub(CheckPermissions)

	F.ODBC.Connection!con.OpenCompanyConnection(500)
	
	F.Intrinsic.Control.If(V.Global.bEditPO,=,False,and,V.Global.bPOReceipt,=,False)
	F.Intrinsic.Control.AndIf(V.Global.bPOReceiptShipping,=,False)
		Gui.FrmPO.cmdEmail.Enabled(False)
		Gui.FrmPO.chkPrevEmls.Enabled(False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.cmdEmail.Enabled(True)
		Gui.FrmPO.chkPrevEmls.Enabled(True)
	F.Intrinsic.Control.EndIf	
		
	Gui.FrmPO..Show	
	F.Intrinsic.Control.CallSub(SetContextMenus)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(callsubs)
	F.Intrinsic.Control.UnBlockEvents
	Gui.FrmPO.optView.Value(True)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}.",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.CheckPermissions.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.bChecked.Declare(boolean,false)
	
	'Check if the User has permission to view Purchase Orders
	Function.Global.Security.CheckUserAccessIPM(266,0,V.Global.bViewPO)'Purchasing > View > Purchase Orders
	Function.Global.Security.CheckUserAccessIPM(321,0,V.Global.bViewPart)'Inventory > View > Supply and Demand
	F.Intrinsic.Control.IF(V.Global.bViewPO,=,True,or,V.Global.bViewPart,=,True)
		Gui.FrmPO.optView.Enabled(True)
		F.Intrinsic.Control.If(V.Local.bChecked,=,False)
			Gui.FrmPO.optView.Value(True)
			V.Local.bChecked.Set(True)
		F.Intrinsic.Control.EndIf		
	F.Intrinsic.Control.Else
		Gui.FrmPO.optView.Enabled(False)
		Gui.FrmPO.optView.Value(False)
		V.Local.bChecked.Set(False)
	F.Intrinsic.Control.EndIF
	
	'Check if the User has permission to open Purchase Orders
	Function.Global.Security.CheckUserAccessIPM(265,1,V.Global.bEditPO)'Purchasing > File > Purchase Orders Manual > Open
	Function.Global.Security.CheckUserAccessIPM(371,0,V.Global.bEditPart)'Inventory > View > Supply and Demand with Edit
	F.Intrinsic.Control.IF(V.Global.bEditPO,=,True,or,V.Global.bEditPart,=,True)
		Gui.FrmPO.optEdit.Enabled(True)
		F.Intrinsic.Control.If(V.Local.bChecked,=,False)
			Gui.FrmPO.optEdit.Value(True)
			V.Local.bChecked.Set(True)
		F.Intrinsic.Control.EndIf		
	F.Intrinsic.Control.Else
		Gui.FrmPO.optEdit.Enabled(False)
		Gui.FrmPO.optEdit.Value(False)
		V.Local.bChecked.Set(False)
	F.Intrinsic.Control.EndIF
	
	'Check if the User has permission to Receive Purchase Orders
	Function.Global.Security.CheckUserAccessIPM(270,0,V.Global.bPOReceipt)'Purchasing > Transactions > P.O. Receipts
	Function.Global.Security.CheckUserAccessIPM(663,0,V.Global.bPOReceiptShipping)'Shipping & Receiving > Transactions > P.O. Receipts
	F.Intrinsic.Control.If(V.Global.bPOReceipt,=,True,or,V.Global.bPOReceiptShipping,=,True)
		Gui.FrmPO.optRecV.Enabled(True)
		F.Intrinsic.Control.If(V.Local.bChecked,=,False)
			Gui.FrmPO.optRecV.Value(True)
			V.Local.bChecked.Set(True)
		F.Intrinsic.Control.EndIf		
	F.Intrinsic.Control.Else
		Gui.FrmPO.optRecV.Enabled(False)
		Gui.FrmPO.optRecV.Value(False)
		V.Local.bChecked.Set(False)
	F.Intrinsic.Control.EndIf
	
	Function.Global.Security.CheckUserAccessIPM(296,0,V.Global.bOutsidePO)'Purchasing > File > Outside P.O. Print On-Line
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPermissions.End

Program.Sub.FrmPO_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.FrmPO_UnLoad.End

Program.Sub.SetAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Anchor Values
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmPO.picGSSLogo.Anchor(1)
	'Gui.FrmPO.frameButtons.Anchor(9)
	Gui.FrmPO.framePermissions.Anchor(9)
	Gui.FrmPO.tabPODash.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetAnchors.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.bPOEditPermission.Declare(Boolean)
	Function.Global.Security.CheckUserAccessIPM(265,1,V.Local.bPOEditPermission)
		
	Gui.FrmPO..ContextMenuCreate("ctxAll")
	Gui.FrmPO.GsGCAllPOs.ContextMenuAttach("ctxAll")
	Gui.FrmPO..ContextMenuAddItem("ctxAll","Refresh",0,"Refresh")
	Gui.FrmPO..ContextMenuAddItem("ctxAll","Export",0,"Export")
		F.Intrinsic.Control.IF(V.Local.bPOEditPermission,=,True)
		Gui.FrmPO..ContextMenuAddItem("ctxAll","New",0,"New Purchase Order")
	F.Intrinsic.Control.EndIf
	Gui.FrmPO..ContextMenuAddItem("ctxAll","ResetColumns",0,"Reset Columns")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxAll","Refresh","MenuClickRefresh")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxAll","Export","MenuClickExport")	
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxAll","New","MenuClickNew")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxAll","ResetColumns","MenuClickResetColumns")
	
	Gui.FrmPO..ContextMenuCreate("ctxToday")
	Gui.FrmPO.GsGCExpToday.ContextMenuAttach("ctxToday")
	Gui.FrmPO..ContextMenuAddItem("ctxToday","Refresh",0,"Refresh")
	Gui.FrmPO..ContextMenuAddItem("ctxToday","Export",0,"Export")
	F.Intrinsic.Control.IF(V.Local.bPOEditPermission,=,True)
		Gui.FrmPO..ContextMenuAddItem("ctxToday","New",0,"New Purchase Order")
	F.Intrinsic.Control.EndIf
	Gui.FrmPO..ContextMenuAddItem("ctxToday","ResetColumns",0,"Reset Columns")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxToday","Refresh","MenuClickRefresh")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxToday","Export","MenuClickExport")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxToday","New","MenuClickNew")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxToday","ResetColumns","MenuClickResetColumns")
	
	Gui.FrmPO..ContextMenuCreate("ctxLate")
	Gui.FrmPO.GsGCPastDue.ContextMenuAttach("ctxLate")
	Gui.FrmPO..ContextMenuAddItem("ctxLate","Refresh",0,"Refresh")
	Gui.FrmPO..ContextMenuAddItem("ctxLate","Export",0,"Export")
	F.Intrinsic.Control.IF(V.Local.bPOEditPermission,=,True)
		Gui.FrmPO..ContextMenuAddItem("ctxLate","New",0,"New Purchase Order")
	F.Intrinsic.Control.EndIf
	Gui.FrmPO..ContextMenuAddItem("ctxLate","ResetColumns",0,"Reset Columns")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxLate","Refresh","MenuClickRefresh")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxLate","Export","MenuClickExport")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxLate","New","MenuClickNew")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxLate","ResetColumns","MenuClickResetColumns")
	
	Gui.FrmPO..ContextMenuCreate("ctxOSV")
	Gui.FrmPO.GsGCOSV.ContextMenuAttach("ctxOSV")
	Gui.FrmPO..ContextMenuAddItem("ctxOSV","Refresh",0,"Refresh")
	Gui.FrmPO..ContextMenuAddItem("ctxOSV","Export",0,"Export")
	F.Intrinsic.Control.IF(V.Local.bPOEditPermission,=,True)
		Gui.FrmPO..ContextMenuAddItem("ctxOSV","New",0,"New Purchase Order")
	F.Intrinsic.Control.EndIf
	Gui.FrmPO..ContextMenuAddItem("ctxOSV","ResetColumns",0,"Reset Columns")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxOSV","Refresh","MenuClickRefresh")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxOSV","Export","MenuClickExport")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxOSV","New","MenuClickNew")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxOSV","ResetColumns","MenuClickResetColumns")
	
	Gui.FrmPO..ContextMenuCreate("ctxReq")
	Gui.FrmPO.GsGcReqs.ContextMenuAttach("ctxReq")
	Gui.FrmPO..ContextMenuAddItem("ctxReq","Refresh",0,"Refresh")
	Gui.FrmPO..ContextMenuAddItem("ctxReq","Export",0,"Export")	
	F.Intrinsic.Control.IF(V.Local.bPOEditPermission,=,True)
		Gui.FrmPO..ContextMenuAddItem("ctxReq","New",0,"New Purchase Order")
	F.Intrinsic.Control.EndIf
	Gui.FrmPO..ContextMenuAddItem("ctxReq","ResetColumns",0,"Reset Columns")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxReq","Refresh","MenuClickRefresh")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxReq","Export","MenuClickExport")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxReq","New","MenuClickNew")
	Gui.FrmPO..ContextMenuSetItemEventHandler("ctxReq","ResetColumns","MenuClickResetColumns")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClickRefresh.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefresh.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.sControl.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXALL")
			V.Local.sControl.Set("GsGCAllPOs")
		F.Intrinsic.Control.Case("CTXTODAY")
			V.Local.sControl.Set("GsGCExpToday")
		F.Intrinsic.Control.Case("CTXLATE")
			V.Local.sControl.Set("GsGCPastDue")
		F.Intrinsic.Control.Case("CTXOSV")
			V.Local.sControl.Set("GsGCOSV")
		F.Intrinsic.Control.Case("CTXREQ")
			V.Local.sControl.Set("GsGcReqs")
	F.Intrinsic.Control.EndSelect

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
	F.Intrinsic.Control.If(V.Local.bExcel)
		F.Intrinsic.String.Build("{0}\GCG_6300_{1}_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)		
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmPO.[V.Local.sControl].Export(V.Local.sFileExport,"xlsx")			
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\GCG_6300_{1}_Export.csv",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmPO.[V.Local.sControl].Export(V.Local.sFileExport,"csv")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.MenuClickResetColumns.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXALL")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
		F.Intrinsic.Control.Case("CTXTODAY")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
		F.Intrinsic.Control.Case("CTXLATE")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
		F.Intrinsic.Control.Case("CTXOSV")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
		F.Intrinsic.Control.Case("CTXREQ")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVREQS",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
	F.Intrinsic.Control.EndSelect
	
	V.Global.bLoadData.Set(False)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickResetColumns.End

Program.Sub.MenuClickNew.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNewPO..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNew.End

Program.Sub.frmNewPO_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNewPO..Visible(False)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmNewPO_UnLoad.End

Program.Sub.cmdManualPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	
	Gui.frmNewPO..Visible(False)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt)
	F.Global.General.CallWrapperSync(175200,"N!*!!*!")
	F.Global.General.CallWrapperSync(50,"PUR060/N")
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt2)
	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdManualPO_Click.End

Program.Sub.cmdAutoPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	
	Gui.frmNewPO..Visible(False)
	F.Global.General.LaunchMenuTask(294,0,V.Local.iRet)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdAutoPO_Click.End

Program.Sub.cmdReFresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.BlockEvents 
	F.Intrinsic.Control.CallSub(callsubs)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdReFresh_Click.End

Program.Sub.CheckLongPart.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Global.General.ReadOption("400861",0,False,"0000",V.Global.bLongPart)
	F.Intrinsic.Control.If(V.Global.bLongPart,=,False)
		F.Global.General.ReadOption("400861",0,False,"0004",V.Global.bLongPart)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckLongPart.End

Program.Sub.CheckPrevEmail.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bRet.Declare

	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",6300,2000,0,"",V.Local.bRet)
	Gui.FrmPO.chkPrevEmls.Value(V.Local.bRet)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPrevEmail.End

Program.Sub.tabPODash_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.SelectCase(V.Screen.FrmPO!tabPODash.Tab)
		F.Intrinsic.Control.Case(0)
			Gui.FrmPO.txtLate.Visible(True)
			Gui.FrmPO.txtInsp.Visible(True)
		F.Intrinsic.Control.CaseAny(1,2)
			Gui.FrmPO.txtLate.Visible(False)
			Gui.FrmPO.txtInsp.Visible(True)
		F.Intrinsic.Control.CaseAny(3,4)
			Gui.FrmPO.txtLate.Visible(False)
			Gui.FrmPO.txtInsp.Visible(False)
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.tabPODash_Click.End

Program.Sub.LoadDTAllPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.sSQL.Declare
	
	'Check to see if DataTable already Exists and if so, close it
	F.Intrinsic.Control.IF(V.DataTable.dtAllPOs.Exists)
		F.Data.DataTable.Close("dtAllPOs")
		Gui.FrmPO.GsGCAllPOs.ClearGrouping("gvAllPOs")
	F.Intrinsic.Control.EndIF
	
	V.Global.bLoadData.Set(True)

	'Create DataTable from SQL
	'6300
	F.Data.DataTable.CreateFromSQL("dtAllPOs","con","Select Distinct Cast(0 As Bit) As Email,Case When D.Conf Is Null Then Convert(0,SQL_BIT) When Conf = 0 Then Convert(0,SQL_BIT) When Conf = 1 Then Convert(1,SQL_BIT) End As CONF,A.PURCHASE_ORDER,Left(A.RECORD_NO,3) AS RECORD_NO,RTRIM(A.PURCHASE_ORDER)+Left(A.RECORD_NO,3) as POLn,B.VENDOR,B.NAME_VENDOR,Coalesce(A.PART,'') AS PART,RTRIM(A.PART)+RTRIM(A.LOCATION) as PartLoc,'' As DISPLAY_PART,A.LOCATION,A.DESCRIPTION,A.PRODUCT_LINE,C.BUYER,' ' as IMPACT1,' ' as IMPACT,' ' as IM_LT,' ' as PO_STAGE,' ' as PO_OWNER,C.DATE_ORDER AS PO_DATE,A.DATE_DUE_LINE,A.QTY_ORDER,A.QTY_RECEIVED,A.QTY_REJECT AS QTY_REJECT,(A.QTY_ORDER-A.QTY_RECEIVED-A.QTY_REJECT) AS QTY_OPEN,A.QTY_RECD_NOT_INSP,A.COST,A.EXTENSION,A.JOB,A.SUFFIX,RTrim(C.SHIP_VIA) As SHIP_VIA,A.BLANKET_PO,Case When Type = 0 Then If(SubString(PART,17,1) = '*','Outside','Normal') When TYPE = 1 Then 'Blanket' End AS PO_TYPE,RTrim(F.SHIP_TO_SEQ) AS SHIPTO,E.NOTES,A.USER_5,Cast(Case Requires_Insp When 'Y' Then 1 Else 0 End As Bit) As Requires_Insp,RTrim(B.Contact_Name) As Contact_Name,RTrim(B.Contact_Email) As Contact_Email From V_PO_Lines A Left Join V_PO_Vendor_Buy B ON A.Purchase_Order = B.Purchase_Order Left Join V_PO_Header C ON A.Purchase_Order = C.Purchase_Order Left Join Gab_PO_Confchk D ON A.Purchase_Order = D.Purchase_Order Left Join Gab_4163_PO_Notes E ON A.Purchase_Order = E.PO AND A.Record_No = CONCAT(E.POLine,0) Left Join V_PO_Pay_To F ON A.Purchase_Order = F.Purchase_Order Where C.Flag_Recv_Closed <> 'Y' And A.FLAG_RECV_CLOSE <> 'Y' And QTY_OPEN <> 0 Order By A.DATE_DUE_LINE;",True)
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtAllPOs",0,"PART","DISPLAY_PART")
	F.Intrinsic.Control.Else
		F.Data.DataTable.CopyColumn("dtAllPOs","PART","DISPLAY_PART")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.AddExpressionColumn("dtAllPOs","OPENEXTENSION","float","COST*QTY_OPEN")
	
	'6300
	'Fill in inventory lead time
	F.Data.Dictionary.CreateFromSQL("dictLeadTime","con","Select RTRIM(PART)+RTRIM(LOCATION) as PartLoc,TIME_MATERIAL_LEAD from V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dictLeadTime",0)	
	F.Data.Datatable.FillFromDictionary("dtAllPOs","dictLeadTime","PartLoc","IM_LT")
	F.Data.Dictionary.Close("dictLeadTime")
	'Write "Y" if there is an impact for this PO
	F.Intrinsic.String.Build("Select RTRIM(CNTRL_NUM)+If(CNTRL_SUF_LN is not null,RTRIM(CNTRL_SUF_LN),'') as POLn,'Y' as IMP_EXISTS from GCG_6300_IMPACTS;",,V.Local.sSQL)
	F.Data.Dictionary.CreateFromSQL("dictImpact","con",V.Local.sSQL)
	F.Data.Dictionary.SetDefaultReturn("dictImpact","")
	F.Data.Datatable.FillFromDictionary("dtAllPOs","dictImpact","POLn","IMPACT1")
	F.Data.Dictionary.Close("dictImpact")
	
	'Creating datatable to generate multiple dictionaries
	F.Intrinsic.String.Build("Select RTRIM(CNTRL_NUM)+RTRIM(CNTRL_SUF_LN) as POLn,CURRENT_STAGE,CURRENT_OWNER from GCG_6300_CTRL_STAT where {0}TYPE{0} = 'PO'",v.Ambient.DblQuote,V.Local.sSQL)
	F.Data.Datatable.CreateFromSQL("dtCntrl","con",V.Local.sSQL)

	F.Intrinsic.Control.If(V.DataTable.dtCntrl.RowCount,<>,0)
		'Fill in the current Stage of the PO
		F.Data.Dictionary.CreateFromDatatable("dictStage","dtCntrl","POLn","CURRENT_STAGE")
		F.Data.Dictionary.SetDefaultReturn("dictStage","")
		F.Data.Datatable.FillFromDictionary("dtAllPOs","dictStage","POLn","PO_STAGE")
		F.Data.Dictionary.Close("dictStage")
		'Fill the current owner of the PO
		F.Data.Dictionary.CreateFromDatatable("dictOwn","dtCntrl","POLn","CURRENT_OWNER")
		F.Data.Dictionary.SetDefaultReturn("dictOwn","")
		F.Data.Datatable.FillFromDictionary("dtAllPOs","dictOwn","POLn","PO_OWNER")
		F.Data.Dictionary.Close("dictOwn")
	F.Intrinsic.Control.EndIf
	
	F.Data.Datatable.Close("dtCntrl")
	'/6300
	
	'Call Subroutine to build GridView to Grid on form
	F.Intrinsic.Control.CallSub(LoadDvGvAllPOs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTAllPOs.End

Program.Sub.LoadDvGvAllPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare
	'6300
	V.Local.sRedImgPath.Declare
	V.Local.sWhiteImgPath.Declare
	V.Local.sRet.Declare
	V.Local.iColumn.Declare
	V.Local.sSQL.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCAllPOs.AddGridviewFromDatatable("gvAllPOs","dtAllPOs")
	Gui.FrmPO.GsGCAllPOs.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","MultiSelect",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","AllowSort",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","AllowFilter",True)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCAllPOs.SetGridViewProperty("gvAllPOs","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCAllPOs.SetGridviewProperty("gvAllPOs","OptionsFilterUseNewCustomFilterDialog",True)
	Gui.FrmPO.GsGCAllPOs.SetGridviewProperty("gvAllPOs","OptionsViewColumnAutoWidth",False)
	Gui.FrmPO.GsGCAllPOs.SetGridviewProperty("gvAllPOs","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","VENDOR","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","POLn","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PartLoc","Visible",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT1","Visible",False)

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","Caption","Email")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","Caption","PO")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","Caption","Impact")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IM_LT","Caption","IM LT")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_STAGE","Caption","Current PO Stage")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_OWNER","Caption","Current PO Owner")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_REJECT","Caption","Qty Rejected")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Order Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Open Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","OPENEXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","Caption","Job")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","Caption","Type")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","Caption","Req. Insp.")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","Caption","Contact Name")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","Caption","Email Address")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Conf","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","MinWidth","130")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_REJECT","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","MinWidth","95")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","OPENEXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","MinWidth","55")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","MinWidth","85")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","MinWidth","120")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","MinWidth","200")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_STAGE","MinWidth","120")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_OWNER","MinWidth","120")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","MaxWidth","60")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IM_LT","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_STAGE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_OWNER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_REJECT","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","OPENEXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","HeaderFontBold",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_REJECT","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","OPENEXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IM_LT","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","CellHAlignment","Center")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IM_LT","CellHAlignment","Center")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","Fixed","Left")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","Fixed","Left")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","Fixed","Left")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_REJECT","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","QTY_RECD_NOT_INSP","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","COST","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","OPENEXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Requires_Insp","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_STAGE","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_OWNER","AllowEdit",True)

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","ReadOnly",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Name","ReadOnly",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Contact_Email","ReadOnly",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","IMPACT","ReadOnly",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_STAGE","ReadOnly",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_OWNER","ReadOnly",False)
	
	F.Intrinsic.Control.If(V.Global.bViewPO,=,True,or,V.Global.bEditPO,=,True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PURCHASE_ORDER","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","RECORD_NO","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","LOCATION","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DESCRIPTION","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf
		
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","PART","MinWidth","250")
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optEdit.Value,=,True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",False)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
	F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optRecV.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optRecV.Value,=,True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",False)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",False)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",True)
		Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",True)
	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
	F.Data.DataTable.Select("dtAllPOs","Requires_Insp = True",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",3,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",3,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOs",3,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	'Past Due mark Pink
	F.Intrinsic.String.Build("DATE_DUE_LINE < #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sExp)
	F.Data.DataTable.Select("dtAllPOs",V.Local.sExp,V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmPO.GsGCAllPOs.SetRowAppearance("gvAllPOs",V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Pink")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
			
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "EXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "OPENEXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "COST", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "QTY_OPEN", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "QTY_ORDER", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "QTY_RECEIVED", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "QTY_REJECT", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOS", "QTY_RECD_NOT_INSP", "DisplayCustomNumeric", "n2")	
	
	'6300
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_RedBox.png",V.Caller.GlobalDir,V.Local.sRedImgPath)
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_WhiteBox.png",V.Caller.GlobalDir,V.Local.sWhiteImgPath)
'	
'	Gui.FrmPO.GsGCAllPOs.GetColumnIndexByName("gvAllPOS","IMPACT",V.Local.iColumn)
'	
'	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtAllPOs.RowCount--,1)
'		F.Intrinsic.Control.If(V.DataTable.dtAllPOs(V.Local.iCnt).IMPACT1!FieldValTrim,=,"Y")
'			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOS",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sRedImgPath)
'		F.Intrinsic.Control.Else
'			Gui.FrmPO.GsGCAllPOs.SetCellAppearance("gvAllPOS",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sWhiteImgPath)
'		F.Intrinsic.Control.EndIf
'	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCAllPOs.AddStyleFormatCondition("gvAllPOS","IMPACT","SetBox","Expression","IMPACT1 = 'Y'")
	Gui.FrmPO.GsGCAllPOs.SetStyleFormatConditionProperty("gvAllPOS","IMPACT","SetBox",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed)
	
	'Populate PO Owner drop down on Gridview
	F.ODBC.Connection!comm.OpenCommonConnection
		F.Intrinsic.String.Build("Select GS_USER,RTRIM(GS_USER)+' | '+RTRIM(FIRST_NAME) from USER_INFORMATION where COMPANY = '{0}' or COMPANY = '' order by GS_USER",V.Caller.CompanyCode,V.Local.sSQL)
		F.Data.Dictionary.CreateFromSQL("dictUsers","comm",V.Local.sSQL)
	F.ODBC.Connection!comm.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictUsers",V.Local.sRet)
	
	F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
	F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
	V.Local.sRet.RedimPreserve
	F.Intrinsic.String.Build("*!*{0}",V.Local.sRet,V.Local.sRet)
	Gui.FrmPO.GsGCAllPOs.ColumnEdit("gvAllPOS","PO_OWNER","DropDownList",V.Local.sRet)
	F.Data.Dictionary.Close("dictUsers")
	
	'Populate WO Stage dropdown on Gridview
	F.ODBC.Connection!conts.OpenCompanyConnection
		F.Data.Dictionary.CreateFromSQL("dictStage","conts","Select TYPE+DDL_VALUE,DDL_VALUE from GCG_6300_MX where TYPE = 'PO' and DDL_TYPE = 'STAGE'")
	F.ODBC.Connection!conts.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictStage",V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
		F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
		V.Local.sRet.RedimPreserve
		Gui.FrmPO.GsGCAllPOs.ColumnEdit("gvAllPOS","PO_STAGE","DropDownList",V.Local.sRet)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCAllPOs.ColumnEdit("gvAllPOS","PO_STAGE","DropDownList","")
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.Close("dictStage")
	
	'/6300

	Gui.FrmPO.GsGCAllPOs.ResumeLayout()
	Gui.FrmPO.GsGCAllPOs.MainView("gvAllPOs")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvAllPOs.End

Program.Sub.LoadDTExpToday.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.IF(V.DataView.dtAllPOs!dvExpToday.Exists,=,True)
		Gui.FrmPO.GsGCExpToday.ClearGrouping("gvExpToday")
		F.Data.DataView.Close("dtAllPOs","dvExpToday")		
	F.Intrinsic.Control.EndIF

	F.Intrinsic.String.Build("DATE_DUE_LINE = #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sFilter)
	F.Data.DataView.Create("dtAllPOs","dvExpToday",22,V.Local.sFilter,"")
	'F.Data.DataView.ToDataTable("dtAllPOs","dvExpToday","dtExpToday",True)
	
	F.Intrinsic.Control.CallSub(LoadDvGvExpToday)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTExpToday.End

Program.Sub.LoadDvGvExpToday.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare
	'6300
	V.Local.sRedImgPath.Declare
	V.Local.sWhiteImgPath.Declare
	V.Local.iColumn.Declare
	V.Local.sRet.Declare
	V.Local.sSQL.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCExpToday.AddGridviewFromDataview("gvExpToday","dtAllPOs","dvExpToday")
	Gui.FrmPO.GsGCExpToday.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","MultiSelect",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","AllowSort",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","AllowFilter",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCExpToday.SetGridViewProperty("gvExpToday","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCExpToday.SetGridviewProperty("gvExpToday","OptionsFilterUseNewCustomFilterDialog",True)
	Gui.FrmPO.GsGCExpToday.SetGridviewProperty("gvExpToday","OptionsViewColumnAutoWidth",False)
	Gui.FrmPO.GsGCExpToday.SetGridviewProperty("gvExpToday","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","VENDOR","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","POLn","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PartLoc","Visible",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT1","Visible",False)

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","Caption","Email")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","Caption","PO")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","Caption","Impact")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IM_LT","Caption","IM LT")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_STAGE","Caption","Current PO Stage")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_OWNER","Caption","Current PO Owner")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_REJECT","Caption","Qty Rejected")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Order Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Open Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","OPENEXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","Caption","Job")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","Caption","Type")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","Caption","Req. Insp.")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","Caption","Contact Name")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","Caption","Email Address")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Conf","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","MinWidth","130")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_REJECT","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","MinWidth","95")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","OPENEXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","MinWidth","55")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","MinWidth","85")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","MinWidth","120")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","MinWidth","200")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_STAGE","MinWidth","120")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_OWNER","MinWidth","120")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","MaxWidth","60")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IM_LT","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_STAGE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_OWNER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_REJECT","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","OPENEXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","HeaderFontBold",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_REJECT","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","OPENEXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IM_LT","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","CellHAlignment","Center")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IM_LT","CellHAlignment","Center")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","Fixed","Left")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","Fixed","Left")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","Fixed","Left")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_REJECT","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","QTY_RECD_NOT_INSP","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","COST","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","OPENEXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Requires_Insp","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_STAGE","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_OWNER","AllowEdit",True)

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Name","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Contact_Email","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","IMPACT","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_STAGE","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_OWNER","ReadOnly",False)
	
	F.Intrinsic.Control.If(V.Global.bViewPO,=,True,or,V.Global.bEditPO,=,True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PURCHASE_ORDER","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","RECORD_NO","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","LOCATION","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DESCRIPTION","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf		

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","PART","MinWidth","250")
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optEdit.Value,=,True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",False)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optRecV.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optRecV.Value,=,True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",False)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",False)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",True)
		Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",True)
	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
'	F.Data.DataTable.Select("dtExpToday","Requires_Insp = True",V.Local.sSelect)
'	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
'		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
'		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",3,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",3,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",3,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
'		F.Intrinsic.Control.Next(V.Local.iCnt)
'	F.Intrinsic.Control.EndIf

	Gui.FrmPO.GsGCExpToday.AddStyleFormatCondition("gvExpToday","PURCHASE_ORDER","SetBox","Expression","Requires_Insp = 'True'")
	Gui.FrmPO.GsGCExpToday.SetStyleFormatConditionProperty("gvExpToday","PURCHASE_ORDER","SetBox",V.Enum.ConditionalPropertyNames!BackColor,"Gold")
	
	Gui.FrmPO.GsGCExpToday.AddStyleFormatCondition("gvExpToday","RECORD_NO","SetBox","Expression","Requires_Insp = 'True'")
	Gui.FrmPO.GsGCExpToday.SetStyleFormatConditionProperty("gvExpToday","RECORD_NO","SetBox",V.Enum.ConditionalPropertyNames!BackColor,"Gold")
	
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "EXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "OPENEXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "COST", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "QTY_OPEN", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "QTY_ORDER", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "QTY_RECEIVED", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "QTY_REJECT", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday", "QTY_RECD_NOT_INSP", "DisplayCustomNumeric", "n2")
	
	'6300
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_RedBox.png",V.Caller.GlobalDir,V.Local.sRedImgPath)
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_WhiteBox.png",V.Caller.GlobalDir,V.Local.sWhiteImgPath)
'	
'	Gui.FrmPO.GsGCExpToday.GetColumnIndexByName("gvExpToday","IMPACT",V.Local.iColumn)

'	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataView.dtAllPOs!dvExpToday.RowCount--,1)
'		F.Intrinsic.Control.If(V.DataView.dtAllPOs!dvExpToday(V.Local.iCnt).IMPACT1!FieldValTrim,=,"Y")
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sRedImgPath)
'		F.Intrinsic.Control.Else
'			Gui.FrmPO.GsGCExpToday.SetCellAppearance("gvExpToday",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sWhiteImgPath)
'		F.Intrinsic.Control.EndIf
'	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCExpToday.AddStyleFormatCondition("gvExpToday","IMPACT","SetBox","Expression","IMPACT1 = 'Y'")
	Gui.FrmPO.GsGCExpToday.SetStyleFormatConditionProperty("gvExpToday","IMPACT","SetBox",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed)
	
	'Populate PO Owner drop down on Gridview
	F.ODBC.Connection!comm.OpenCommonConnection
		F.Intrinsic.String.Build("Select GS_USER,RTRIM(GS_USER)+' | '+RTRIM(FIRST_NAME) from USER_INFORMATION where COMPANY = '{0}' or COMPANY = '' order by GS_USER",V.Caller.CompanyCode,V.Local.sSQL)
		F.Data.Dictionary.CreateFromSQL("dictUsers","comm",V.Local.sSQL)
	F.ODBC.Connection!comm.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictUsers",V.Local.sRet)
	
	F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
	F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
	V.Local.sRet.RedimPreserve
	F.Intrinsic.String.Build("*!*{0}",V.Local.sRet,V.Local.sRet)
	Gui.FrmPO.GsGCExpToday.ColumnEdit("gvExpToday","PO_OWNER","DropDownList",V.Local.sRet)
	
	F.Data.Dictionary.Close("dictUsers")
	
	'Populate PO Stage dropdown on Gridview
	F.ODBC.Connection!conts.OpenCompanyConnection
		F.Data.Dictionary.CreateFromSQL("dictStage","conts","Select TYPE+DDL_VALUE,DDL_VALUE from GCG_6300_MX where TYPE = 'PO' and DDL_TYPE = 'STAGE'")
	F.ODBC.Connection!conts.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictStage",V.Local.sRet)
	
	'fixed bug, missing If statement to check for NORETURN. 7/22/21 SS
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
		F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
		V.Local.sRet.RedimPreserve
		Gui.FrmPO.GsGCExpToday.ColumnEdit("gvExpToday","PO_STAGE","DropDownList",V.Local.sRet)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCExpToday.ColumnEdit("gvExpToday","PO_STAGE","DropDownList","")
	F.Intrinsic.Control.EndIf
	F.Data.Dictionary.Close("dictStage")
	'/6300
	
	Gui.FrmPO.GsGCExpToday.ResumeLayout()
	Gui.FrmPO.GsGCExpToday.MainView("gvExpToday")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvExpToday.End

Program.Sub.LoadDTPastDue.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.IF(V.DataView.dtAllPOs!dvPastDue.Exists,=,True)
		F.Data.Dataview.Close("dtAllPOs","dvPastDue")
		Gui.FrmPO.GsGCPastDue.ClearGrouping("gvPastDue")
	F.Intrinsic.Control.EndIF

	F.Intrinsic.String.Build("DATE_DUE_LINE < #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sFilter)
	F.Data.DataView.Create("dtAllPOs","dvPastDue",22,V.Local.sFilter,"")
	'F.Data.DataView.ToDataTable("dtAllPOs","dvPastDue","dtPastDue",True)

	F.Intrinsic.Control.CallSub(LoadDvGvPastDue)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTPastDue.End

Program.Sub.LoadDvGvPastDue.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare
	'6300
	V.Local.sRedImgPath.Declare
	V.Local.sWhiteImgPath.Declare
	V.Local.iColumn.Declare
	V.Local.sRet.Declare
	V.Local.sSQL.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCPastDue.AddGridviewFromDataview("gvPastDue","dtAllPOs","dvPastDue")
	Gui.FrmPO.GsGCPastDue.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","MultiSelect",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","AllowSort",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","AllowFilter",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCPastDue.SetGridViewProperty("gvPastDue","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCPastDue.SetGridviewProperty("gvPastDue","OptionsFilterUseNewCustomFilterDialog",True)
	Gui.FrmPO.GsGCPastDue.SetGridviewProperty("gvPastDue","OptionsViewColumnAutoWidth",False)
	Gui.FrmPO.GsGCPastDue.SetGridviewProperty("gvPastDue","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","VENDOR","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","POLn","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PartLoc","Visible",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT1","Visible",False)

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","Caption","Email")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","Caption","Confirmation")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","Caption","PO")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","Caption","Ln")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","Caption","Impact")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IM_LT","Caption","IM LT")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_STAGE","Caption","Current PO Stage")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_OWNER","Caption","Current PO Owner")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","Caption","PO Date")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","Caption","Due Date")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","Caption","Order Qty")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","Caption","Qty Received")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_REJECT","Caption","Qty Rejected")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","Caption","Qty Open")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","Caption","Qty In Insp.")
	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Order Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Open Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","OPENEXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","Caption","Job")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","Caption","Ship Via")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","Caption","Blanket PO")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","Caption","Type")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","Caption","Ship To")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","Caption","Notes ")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","Caption","Req. Insp.")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","Caption","Contact Name")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","Caption","Email Address")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Conf","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","MinWidth","25")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","MinWidth","130")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","MinWidth","50")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_REJECT","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","MinWidth","95")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","OPENEXTENSION","MinWidth","105")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","MinWidth","125")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","MinWidth","75")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","MinWidth","55")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","MinWidth","90")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","MinWidth","85")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","MinWidth","120")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","MinWidth","200")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_STAGE","MinWidth","120")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_OWNER","MinWidth","120")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","MaxWidth","60")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IM_LT","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_OWNER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_STAGE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_REJECT","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","OPENEXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","HeaderFontBold",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","HeaderFontBold",True)
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_REJECT","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","OPENEXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IM_LT","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","CellHAlignment","Center")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IM_LT","CellHAlignment","Center")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","Fixed","Left")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","Fixed","Left")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","Fixed","Left")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","Fixed","Left")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NAME_VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_ORDER","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECEIVED","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_REJECT","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_OPEN","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","QTY_RECD_NOT_INSP","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","COST","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","OPENEXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIP_VIA","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","BLANKET_PO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_TYPE","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","SHIPTO","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Requires_Insp","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_STAGE","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_OWNER","AllowEdit",True)

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Name","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Contact_Email","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","IMPACT","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_STAGE","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_OWNER","ReadOnly",False)
	
	F.Intrinsic.Control.If(V.Global.bViewPO,=,True,or,V.Global.bEditPO,=,True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PURCHASE_ORDER","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","RECORD_NO","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","LOCATION","CellForeColor",V.Enum.ThemeColors!AccentColor)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DESCRIPTION","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","NOTES","CellBackColor","LightYellow")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","USER_5","CellBackColor","LightYellow")

	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PO_DATE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","PART","MinWidth","250")
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optEdit.Value,=,True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",False)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
	F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optRecV.Enabled)
	F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optRecV.Value,=,True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",False)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",False)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",False)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",True)
		Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",True)
	F.Intrinsic.Control.EndIf
	
	'Requires_Insp mark Gold
'	F.Data.DataTable.Select("dtPastDue","Requires_Insp = True",V.Local.sSelect)
'	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
'		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
'		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",2,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",3,V.Local.sSelect(V.Local.iCnt).Long,"BackColor","Gold")
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",3,V.Local.sSelect(V.Local.iCnt).Long,"ForeColor",V.Enum.ThemeColors!AccentColor)
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",3,V.Local.sSelect(V.Local.iCnt).Long,"HAlignment","Center")
'		F.Intrinsic.Control.Next(V.Local.iCnt)
'	F.Intrinsic.Control.EndIf

	Gui.FrmPO.GsGCPastDue.AddStyleFormatCondition("gvPastDue","PURCHASE_ORDER","SetBox","Expression","Requires_Insp = 'True'")
	Gui.FrmPO.GsGCPastDue.SetStyleFormatConditionProperty("gvPastDue","PURCHASE_ORDER","SetBox",V.Enum.ConditionalPropertyNames!BackColor,"Gold")
	
	Gui.FrmPO.GsGCPastDue.AddStyleFormatCondition("gvPastDue","RECORD_NO","SetBox","Expression","Requires_Insp = 'True'")
	Gui.FrmPO.GsGCPastDue.SetStyleFormatConditionProperty("gvPastDue","RECORD_NO","SetBox",V.Enum.ConditionalPropertyNames!BackColor,"Gold")
	
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "EXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "OPENEXTENSION", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "COST", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "QTY_OPEN", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "QTY_ORDER", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "QTY_RECEIVED", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "QTY_REJECT", "DisplayCustomNumeric", "n2")
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue", "QTY_RECD_NOT_INSP", "DisplayCustomNumeric", "n2")
	
	'6300
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_RedBox.png",V.Caller.GlobalDir,V.Local.sRedImgPath)
'	F.Intrinsic.String.Build("{0}\ART\GCG_6300_WhiteBox.png",V.Caller.GlobalDir,V.Local.sWhiteImgPath)
'	
'	Gui.FrmPO.GsGCPastDue.GetColumnIndexByName("gvPastDue","IMPACT",V.Local.iColumn)
'	
'	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataView.dtAllPOs!dvPastDue.RowCount--,1)
'		F.Intrinsic.Control.If(V.DataView.dtAllPOs!dvPastDue(V.Local.iCnt).IMPACT1!FieldValTrim,=,"Y")
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sRedImgPath)
'		F.Intrinsic.Control.Else
'			Gui.FrmPO.GsGCPastDue.SetCellAppearance("gvPastDue",V.Local.iColumn,V.Local.iCnt,"Image",V.Local.sWhiteImgPath)
'		F.Intrinsic.Control.EndIf
'	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCPastDue.AddStyleFormatCondition("gvPastDue","IMPACT","SetBox","Expression","IMPACT1 = 'Y'")
	Gui.FrmPO.GsGCPastDue.SetStyleFormatConditionProperty("gvPastDue","IMPACT","SetBox",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed)
	
	'Populate PO Owner drop down on Gridview
	F.ODBC.Connection!comm.OpenCommonConnection
		F.Intrinsic.String.Build("Select GS_USER,RTRIM(GS_USER)+' | '+RTRIM(FIRST_NAME) from USER_INFORMATION where COMPANY = '{0}' or COMPANY = '' order by GS_USER",V.Caller.CompanyCode,V.Local.sSQL)
		F.Data.Dictionary.CreateFromSQL("dictUsers","comm",V.Local.sSQL)
	F.ODBC.Connection!comm.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictUsers",V.Local.sRet)
	
	F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
	F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
	V.Local.sRet.RedimPreserve
	F.Intrinsic.String.Build("*!*{0}",V.Local.sRet,V.Local.sRet)
	Gui.FrmPO.GsGCPastDue.ColumnEdit("gvPastDue","PO_OWNER","DropDownList",V.Local.sRet)
	F.Data.Dictionary.Close("dictUsers")
	
	'Populate WO Stage dropdown on Gridview
	F.ODBC.Connection!conts.OpenCompanyConnection
		F.Data.Dictionary.CreateFromSQL("dictStage","conts","Select TYPE+DDL_VALUE,DDL_VALUE from GCG_6300_MX where TYPE = 'PO' and DDL_TYPE = 'STAGE'")
	F.ODBC.Connection!conts.Close
	
	F.Data.Dictionary.ReturnAllPairs("dictStage",V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sRet,"!*!",V.Local.sRet)
		F.Intrinsic.Variable.RemoveArrayElementByOrdinal(V.Local.sRet,0,V.Local.sRet)
		V.Local.sRet.RedimPreserve
		F.Intrinsic.String.Build("*!*{0}",V.Local.sRet,V.Local.sRet)
		Gui.FrmPO.GsGCPastDue.ColumnEdit("gvPastDue","PO_STAGE","DropDownList",V.Local.sRet)
	F.Intrinsic.Control.Else
		Gui.FrmPO.GsGCPastDue.ColumnEdit("gvPastDue","PO_STAGE","DropDownList","")
	F.Intrinsic.Control.EndIf	
	
	F.Data.Dictionary.Close("dictStage")
	'/6300
	
	Gui.FrmPO.GsGCPastDue.ResumeLayout()
	Gui.FrmPO.GsGCPastDue.MainView("gvPastDue")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvPastDue.End

Program.Sub.LoadDTReqs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.IF(V.DataTable.dtReqs.Exists)
		F.Data.DataTable.Close("dtReqs")
		Gui.FrmPO.GsGCReqs.ClearGrouping("gvReqs")
	F.Intrinsic.Control.EndIF

	F.Data.DataTable.CreateFromSQL("dtReqs","con","SELECT PR.PO_REQ_NUMBER, PR.PO_REQ_LINE, PR.VENDOR, PR.PRODUCT_LINE, COALESCE(PR.PART,'') AS PART,'' As DISPLAY_PART, PR.LOCATION, PR.DESCRIPTION, PR.DATE_DUE, PR.QUANTITY, PR.UNIT_PRICE, (SELECT (QUANTITY * UNIT_PRICE) FROM V_PURCHASE_REQS WHERE PR.PO_REQ_NUMBER = PO_REQ_NUMBER AND PR.PO_REQ_LINE = PO_REQ_LINE) AS EXTENSION , PR.BUYER, PR.JOB, PR.SUFFIX, CASE WHEN PR.SEQUENCE = '000000' THEN ' ' WHEN PR.SEQUENCE <> '000000' THEN PR.SEQUENCE END AS SEQUENCE,PR.UM,PR.GL_ACCOUNT,PR.DATE_ORIGINAL,PR.SORT_CODE,PR.USER_REF,PR.INVENTORY_UM,PR.INVENTORY_QTY,PR.USERID_ORIGINATOR FROM V_PURCHASE_REQS PR;",True)
	F.Intrinsic.Control.If(V.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtReqs",0,"PART","DISPLAY_PART")
	F.Intrinsic.Control.Else
		F.Data.DataTable.CopyColumn("dtReqs","PART","DISPLAY_PART")
	F.Intrinsic.Control.EndIf

	'Add buyer name from BUYERS table using PURCHASE_REQS.BUYER
	F.Data.Dictionary.CreateFromSQL("dBuyer","con","SELECT BUYER_CODE AS BUYER, BUYER AS BUYER_NAME FROM V_BUYERS;")
	F.Data.Dictionary.SetDefaultReturn("dBuyer","")
	F.Data.DataTable.FillFromDictionary("dtReqs","dBuyer","BUYER")
	F.Data.Dictionary.Close("dBuyer")

	'Add vendor name from VENDOR_MASTER using PURCHASE_REQS.VENDOR
	F.Data.Dictionary.CreateFromSQL("dVendor","con","SELECT VENDOR, NAME_VENDOR AS VENDOR FROM V_VENDOR_MASTER;")
	F.Data.Dictionary.SetDefaultReturn("dVendor","")
	F.Data.DataTable.FillFromDictionary("dtReqs","dVendor","VENDOR")
	F.Data.Dictionary.Close("dVendor")
	
	F.Intrinsic.Control.CallSub(loaddvgvreqs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTReqs.End

Program.Sub.LoadDvGvReqs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare

	Gui.FrmPO.GsGcReqs.AddGridviewFromDatatable("gvReqs","dtReqs")
	Gui.FrmPO.GsGcReqs.SuspendLayout()
	
	'Set grid properties
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","MultiSelect",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowSort",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowFilter",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCReqs.SetGridViewProperty("gvReqs","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGcReqs.SetGridviewProperty("gvReqs","OptionsFilterUseNewCustomFilterDialog",True)
	Gui.FrmPO.GsGcReqs.SetGridviewProperty("gvReqs","OptionsViewColumnAutoWidth",False)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","Visible",False)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","Caption","Req #")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","Caption","Ln")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","Caption","PL")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","Caption","Part Number")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","Caption","Loc")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","Caption","Due Date")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","Caption","Order Qty")
	F.Intrinsic.String.Build("Cost ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","Caption","Buyer")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","Caption","Job")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","Caption","Seq")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","Caption","Pur UM")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","Caption","GL Account")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","Caption","Date Req")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","Caption","Sort Code")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","Caption","User Ref")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","Caption","Inv UM")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","Caption","Inv Qty")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","Caption","Originator")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","AllowEdit",False)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","AllowEdit",False)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","MinWidth","75")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","MinWidth","15")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","MinWidth","200")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","MinWidth","25")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","MinWidth","130")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","MinWidth","130")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","MinWidth","30")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","MinWidth","200")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","MinWidth","100")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","MinWidth","130")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","MinWidth","75")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","MinWidth","50")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","MinWidth","50")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","MinWidth","60")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","MinWidth","90")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","MinWidth","70")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","MinWidth","65")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","MinWidth","60")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","MinWidth","80")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","MinWidth","80")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","HeaderFontBold",True)
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","HeaderFontBold",True)
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USER_REF","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","HeaderHAlignment","Center")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","VENDOR","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","LOCATION","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DESCRIPTION","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","CellHAlignment","Right")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","CellHAlignment","Right")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","CellHAlignment","Right")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","BUYER","CellHAlignment","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SEQUENCE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UM","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","GL_ACCOUNT","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","SORT_CODE","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_UM","CellHAlignment","Center")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","USERID_ORIGINATOR","CellHAlignment","Center")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_NUMBER","Fixed","Left")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PO_REQ_LINE","Fixed","Left")

	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_DUE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DATE_ORIGINAL","DisplayCustomDatetime","d")
	
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","QUANTITY","DisplayCustomNumeric","n2")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","UNIT_PRICE","DisplayCustomNumeric","n2")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","EXTENSION","DisplayCustomNumeric","n2")
	Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","INVENTORY_QTY","DisplayCustomNumeric","n2")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","PART","MinWidth","250")
		Gui.FrmPO.GsGcReqs.SetColumnProperty("gvReqs","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.GsGcReqs.ResumeLayout()
	Gui.frmPO.GsGcReqs.MainView("gvReqs")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
	
Program.Sub.LoadDvGvReqs.End

Program.Sub.LoadDTOSV.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Check to see if DataTable already Exists and if so, close it
	F.Intrinsic.Control.IF(V.DataTable.dtOSV.Exists,=,True)
		F.Data.DataTable.Close("dtOSV")
		Gui.FrmPO.GsGCOSV.ClearGrouping("gvOSV")
	F.Intrinsic.Control.EndIF

	'Create DataTable from SQL
	V.Local.sSQL.Declare(String,"SELECT C.OPERATION AS VENDOR,D.NAME_VENDOR,COALESCE(B.PART,'') AS MFG_PART,'' As DISPLAY_PART,C.DESCRIPTION,A.QUANTITY,A.JOB,A.JOB_SUFFIX,A.SEQUENCE,C.DATE_DUE,B.DATE_DUE AS JOB_DATE_DUE FROM V_MAT_ONLINE A LEFT OUTER JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.JOB_SUFFIX = B.SUFFIX LEFT OUTER JOIN V_JOB_OPERATIONS C ON A.JOB = C.JOB AND A.JOB_SUFFIX = C.SUFFIX AND A.SEQUENCE = C.SEQ LEFT JOIN V_VENDOR_MASTER D ON C.OPERATION = D.VENDOR WHERE A.MOL_DELETE<>'Y' AND A.MOL_TYPE='O' ORDER BY C.DATE_DUE,C.OPERATION;")
	F.Data.DataTable.CreateFromSQL("dtOSV","con",V.Local.sSQL,True)
	F.Intrinsic.Control.If(V.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtOSV",0,"MFG_PART","DISPLAY_PART")
	F.Intrinsic.Control.Else
		F.Data.DataTable.CopyColumn("dtOSV","MFG_PART","DISPLAY_PART")
	F.Intrinsic.Control.EndIf

	'Call Subroutine to build DataView, GridView and set GridView to Grid on form
	F.Intrinsic.Control.CallSub(loaddvgvosv)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTOSV.End

Program.Sub.LoadDvGvOSV.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.iCnt.Declare

	'Create GridView from DataView
	Gui.FrmPO.GsGCOSV.AddGridViewFromDataTable("gvOSV","dtOSV")
	Gui.FrmPO.GsGCOSV.SuspendLayout()
	'Set Grid Propertites
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","MultiSelect",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","AllowSort",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","AllowFilter",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","OptionsDetailShowDetailTabs",False)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","OptionsViewShowGroupPanel",True)
	Gui.FrmPO.GsGCOSV.SetGridViewProperty("gvOSV","EnableAppearanceOddRow",True)
	Gui.FrmPO.GsGCOSV.SetGridviewProperty("gvOSV","OptionsFilterUseNewCustomFilterDialog",True)
	Gui.FrmPO.GsGCOSV.SetGridviewProperty("gvOSV","OptionsViewColumnAutoWidth",False)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","Visible",False)
	
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","Caption","Vendor")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","Caption","Vendor Name")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","Caption","Mfg Part")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","Caption","Part Description")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","Caption","Quantity")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","Caption","Job")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","Caption","Suffix")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","Caption","Seq")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","Caption","Outside Due Date")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","Caption","WO Due Date")	

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","MinWidth","30")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","MinWidth","150")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","MinWidth","120")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","MinWidth","120")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","MinWidth","180")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","MinWidth","60")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","MinWidth","45")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","MinWidth","95")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","MinWidth","90")
	
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","HeaderFontBold",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","HeaderFontBold",True)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","NAME_VENDOR","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","HeaderHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","HeaderHAlignment","Center")

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","CellHAlignment","Far")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","CellHAlignment","Center")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","CellHAlignment","Center")

	F.Intrinsic.Control.If(V.Global.bOutsidePO)
	F.Intrinsic.Control.AndIf(V.Global.bEditPO)
		Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","CellForeColor",V.Enum.ThemeColors!AccentColor)
	F.Intrinsic.Control.EndIf	

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","AllowEdit",False)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","AllowEdit",False)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","VENDOR","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DESCRIPTION","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","QUANTITY","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_SUFFIX","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","SEQUENCE","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","ReadOnly",True)
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","ReadOnly",True)

	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DATE_DUE","DisplayCustomDatetime","d")
	Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","JOB_DATE_DUE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","MFG_PART","MinWidth","250")
		Gui.FrmPO.GsGCOSV.SetColumnProperty("gvOSV","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf

	Gui.FrmPO.GsGCOSV.ResumeLayout()
	Gui.FrmPO.GsGCOSV.MainView("gvOSV")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDvGvOSV.End

Program.Sub.GsGCAllPOs_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare
	V.Local.sPOLine.Declare

	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPO)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.Control.If(V.Global.bEditPO)
					F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPO)
					F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bPOReceipt,=,True,or,V.Global.bPOReceiptShipping,=,True)
					F.Global.General.CallWrapperSync(3200,V.Local.sPO)
					F.Intrinsic.Control.CallSub(printaudit)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPart)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bEditPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
					F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PART",V.Args.RowIndex,V.Local.sPart)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","LOCATION",V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(7200,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Case("IMPACT")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sPOLine)
			
			F.Intrinsic.Control.CallSub(ImpactData,"PO",V.Local.sPO.Trim,"Line",V.Local.sPOLine.Trim,"CtrlName",V.Args.CONTROLNAME,"sRowIndex",V.Args.ROWINDEX)		
	F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry	
Program.Sub.GsGCAllPOs_RowCellClick.End

Program.Sub.GsGCExpToday_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare
	V.Local.sPOLine.Declare

	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPO)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.Control.If(V.Global.bEditPO)
					F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPO)
					F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bPOReceipt,=,True,or,V.Global.bPOReceiptShipping,=,True)
					F.Global.General.CallWrapperSync(3200,V.Local.sPO)
					F.Intrinsic.Control.CallSub(printaudit)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPart)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bEditPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
					F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
					F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PART",V.Args.RowIndex,V.Local.sPart)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","LOCATION",V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(7200,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Case("IMPACT")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sPOLine)
			
			F.Intrinsic.Control.CallSub(ImpactData,"PO",V.Local.sPO.Trim,"Line",V.Local.sPOLine.Trim,"CtrlName",V.Args.CONTROLNAME,"sRowIndex",V.Args.ROWINDEX)
	F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCExpToday_RowCellClick.End

Program.Sub.GsGCPastDue_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare
	V.Local.sPOLine.Declare

	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("PURCHASE_ORDER","RECORD_NO")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPO)
				F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.FrmPO!optEdit.Value,=,True)
				F.Intrinsic.Control.If(V.Global.bEditPO)
					F.Intrinsic.String.Concat("O!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPO)
					F.Intrinsic.String.Concat("V!*!",V.Local.sPO,"!*!",V.Local.sParams)
					F.Global.General.CallWrapperASync(175200,V.Local.sParams)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bPOReceipt,=,True,or,V.Global.bPOReceiptShipping,=,True)
					F.Global.General.CallWrapperSync(3200,V.Local.sPO)
					F.Intrinsic.Control.CallSub(printaudit)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("DISPLAY_PART","LOCATION")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Screen.FrmPO!optView.Value,=,True)
			F.Intrinsic.Control.AndIf(V.Global.bViewPart)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(300011,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.bEditPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
					F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.ElseIf(V.Global.bViewPart)
					F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
					F.Global.General.CallWrapperASync(300011,V.Local.sParams)
				F.Intrinsic.Control.EndIf				
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DESCRIPTION")
			F.Intrinsic.Control.If(V.Global.bViewPart,=,True,or,V.Global.bEditPart,=,True)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PART",V.Args.RowIndex,V.Local.sPart)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","LOCATION",V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperASync(7200,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Case("IMPACT")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sPOLine)
			
			F.Intrinsic.Control.CallSub(ImpactData,"PO",V.Local.sPO.Trim,"Line",V.Local.sPOLine.Trim,"CtrlName",V.Args.CONTROLNAME,"sRowIndex",V.Args.ROWINDEX)
	F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPastDue_RowCellClick.End

Program.Sub.GsGCOSV_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare

	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("DISPLAY_PART")				
		F.Intrinsic.Control.If(V.Global.bOutsidePO)
		F.Intrinsic.Control.AndIf(V.Global.bEditPO)		
		F.Intrinsic.Control.AndIf(V.Screen.FrmPO!optEdit.Value,=,True)
			F.Global.General.LaunchMenuTask(296,0,V.Local.iRet)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCOSV_RowCellClick.End

Program.Sub.ControlsDisabled.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Gui.FrmPO.frameButtons.Enabled(False)
	Gui.FrmPO.framePermissions.Enabled(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ControlsDisabled.End

Program.Sub.ControlsEnabled.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Gui.FrmPO.frameButtons.Enabled(True)
	Gui.FrmPO.framePermissions.Enabled(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ControlsEnabled.End

Program.Sub.CallSubs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.lbl1.Visible(True)
	Gui.FrmPO.progressBar1.Visible(True)
	Gui.FrmPO.lbl1.Caption("Loading Purchase Orders....")
	Gui.FrmPO.progressBar1.Min(0)
	Gui.FrmPO.progressBar1.Max(100)
	F.Intrinsic.Control.CallSub(loaddtallpos)
	Gui.FrmPO.progressBar1.Value(20)
	F.Intrinsic.Control.CallSub(loaddtexptoday)
	Gui.FrmPO.progressBar1.Value(40)
	F.Intrinsic.Control.CallSub(loaddtpastdue)
	Gui.FrmPO.progressBar1.Value(60)
	F.Intrinsic.Control.CallSub(loaddtosv)
	Gui.FrmPO.progressBar1.Value(80)
	F.Intrinsic.Control.CallSub(loaddtreqs)
	Gui.FrmPO.progressBar1.Value(100)
	Gui.FrmPO.lbl1.Visible(False)
	Gui.FrmPO.progressBar1.Value(0)
	Gui.FrmPO.progressBar1.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CallSubs.End

Program.Sub.GsGCAllPOs_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConF.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	V.Local.sStage.Declare
	V.Local.sOwner.Declare
	V.Local.iColumn.Declare
	V.Local.sUserChk.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvAllPOs","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAllPOs","PO_Note","USER_5")
			
		F.Intrinsic.Control.Case("PO_STAGE")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PO_STAGE",V.Args.RowIndex,V.Local.sStage)
			Gui.FrmPO.GsGCAllPOs.GetColumnIndexByName("gvAllPOS","PO_STAGE",V.Local.iColumn)
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_STAGE) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sStage.PSQLFriendly,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_STAGE = '{0}' where {3}TYPE{3} = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sStage.PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCAllPOs.SetCellValue("gvAllPOS",V.Local.iColumn,V.Args.RowIndex,V.Local.sStage.Trim)

			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			
		F.Intrinsic.Control.Case("PO_OWNER")
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PO_OWNER",V.Args.RowIndex,V.Local.sOwner.Trim)
			Gui.FrmPO.GsGCAllPOs.GetColumnIndexByName("gvAllPOS","PO_OWNER",V.Local.iColumn)
			
			F.Intrinsic.String.Right(V.Local.sOwner.Trim,1,V.Local.sUserChk)

			F.Intrinsic.Control.If(V.Local.sUserChk.Trim,=,"|")
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," |",V.Local.sOwner)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," | ",V.Local.sOwner)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_OWNER) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sOwner(0).PSQLFriendly,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_OWNER = '{0}' where TYPE = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sOwner(0).PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCAllPOs.SetCellValue("gvAllPOS",V.Local.iColumn,V.Args.RowIndex,V.Local.sOwner(0).Trim)
			
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllPOs_CellValueChanged.End

Program.Sub.GsGCExpToday_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConF.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	V.Local.sOwner.Declare
	V.Local.sStage.Declare
	V.Local.iColumn.Declare
	V.Local.sUserChk.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvExpToday","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvExpToday","PO_Note","USER_5")
		'6300	
		F.Intrinsic.Control.Case("PO_STAGE")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PO_STAGE",V.Args.RowIndex,V.Local.sStage)
			Gui.FrmPO.GsGCExpToday.GetColumnIndexByName("gvExpToday","PO_STAGE",V.Local.iColumn)
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_STAGE) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sStage.PSQLFriendly,V.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_STAGE = '{0}' where TYPE = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sStage.PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCExpToday.SetCellValue("gvExpToday",V.Local.iColumn,V.Args.RowIndex,V.Local.sStage.Trim)

			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			
		F.Intrinsic.Control.Case("PO_OWNER")
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PO_OWNER",V.Args.RowIndex,V.Local.sOwner)
			Gui.FrmPO.GsGCExpToday.GetColumnIndexByName("gvExpToday","PO_OWNER",V.Local.iColumn)
			
			F.Intrinsic.String.Right(V.Local.sOwner.Trim,1,V.Local.sUserChk)

			F.Intrinsic.Control.If(V.Local.sUserChk.Trim,=,"|")
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," |",V.Local.sOwner)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," | ",V.Local.sOwner)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_OWNER) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sOwner(0).PSQLFriendly,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_OWNER = '{0}' where TYPE = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sOwner(0).PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCExpToday.SetCellValue("gvExpToday",V.Local.iColumn,V.Args.RowIndex,V.Local.sOwner(0).Trim)
			
			F.ODBC.Connection!con.Execute(V.Local.sSQL)	
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCExpToday_CellValueChanged.End

Program.Sub.GsGCPastDue_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sPO.Declare
	V.Local.sPO2.Declare
	V.Local.bConF.Declare
	V.Local.bConf2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sPOLine.Declare
	V.Local.sLine.Declare
	V.Local.sParams.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	V.Local.sOwner.Declare
	V.Local.sStage.Declare
	V.Local.iColumn.Declare
	V.Local.sUserChk.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!optEdit.Value,=,True)
		F.Intrinsic.Control.If(V.Args.Column,=,"CONF")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","CONF",V.Args.RowIndex,V.Local.bConf)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.String.Concat("SELECT * FROM GAB_PO_CONFCHK WHERE PURCHASE_ORDER='",V.Local.sPO,"'",V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRW("rstSave",V.Local.sSql)
				F.Intrinsic.Control.If(V.ODBC.con!rstSave.EOF,=,True)
					F.ODBC.con!rstSave.AddNew
					F.ODBC.con!rstSave.Set!PURCHASE_ORDER(V.Local.sPO)
				F.Intrinsic.Control.EndIf
				Function.Intrinsic.Control.If(V.Local.bConf,=,False)
					F.ODBC.con!rstSave.Set!CONF("1")
					V.Local.bConf2.Set(True)
				Function.Intrinsic.Control.Else
					F.ODBC.con!rstSave.Set!CONF("0")
					V.Local.bConf2.Set(False)
				Function.Intrinsic.Control.EndIf
				F.ODBC.con!rstSave.Set!GS_USER(V.Caller.User)
				F.ODBC.con!rstSave.Set!DATE_CONF(V.Ambient.Date)
				F.ODBC.con!rstSave.Update
			F.ODBC.con!rstSave.Close
			F.Intrinsic.Control.CallSub(checkpoconf,"PO",V.Local.sPO,"Conf",V.Local.bConf2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM GAB_4163_PO_NOTES WHERE PO = '{0}' AND POLINE = '{1}';",V.Local.sPO,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO GAB_4163_PO_NOTES(PO,POLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE GAB_4163_PO_NOTES SET NOTES = '{0}' WHERE PO = '{1}' AND POLINE = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvPastDue","PO_Note","NOTES")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sPOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM V_PO_LINES WHERE PURCHASE_ORDER = '{0}' AND RECORD_NO = '{1}';",V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO PO_LINES(PURCHASE_ORDER,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sPO,V.Local.sPOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE PO_LINES SET USER_5 = '{0}' WHERE PURCHASE_ORDER = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sPO,V.Local.sPOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"PO",V.Local.sPO,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvPastDue","PO_Note","USER_5")
		'6300	
		F.Intrinsic.Control.Case("PO_STAGE")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PO_STAGE",V.Args.RowIndex,V.Local.sStage)
			Gui.FrmPO.GsGCPastDue.GetColumnIndexByName("gvPastDue","PO_STAGE",V.Local.iColumn)
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_STAGE) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sStage.PSQLFriendly,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_STAGE = '{0}' where TYPE = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sStage.PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCPastDue.SetCellValue("gvPastDue",V.Local.iColumn,V.Args.RowIndex,V.Local.sStage.Trim)

			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			
		F.Intrinsic.Control.Case("PO_OWNER")
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Args.RowIndex,V.Local.sPO)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Args.RowIndex,V.Local.sLine)
			Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PO_OWNER",V.Args.RowIndex,V.Local.sOwner)
			Gui.FrmPO.GsGCPastDue.GetColumnIndexByName("gvPastDue","PO_OWNER",V.Local.iColumn)
			
			F.Intrinsic.String.Right(V.Local.sOwner.Trim,1,V.Local.sUserChk)

			F.Intrinsic.Control.If(V.Local.sUserChk.Trim,=,"|")
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," |",V.Local.sOwner)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Split(V.Local.sOwner.Trim," | ",V.Local.sOwner)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("Select * from GCG_6300_CTRL_STAT where TYPE = 'PO' and CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}'",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Insert into GCG_6300_CTRL_STAT ({3}TYPE{3},CNTRL_NUM,CNTRL_SUF_LN,CURRENT_OWNER) values('PO','{0}','{1}','{2}')",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sOwner(0).PSQLFriendly,v.Ambient.DblQuote,V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GCG_6300_CTRL_STAT set CURRENT_OWNER = '{0}' where TYPE = 'PO' and CNTRL_NUM = '{1}' and CNTRL_SUF_LN = '{2}'",V.Local.sOwner(0).PSQLFriendly,V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			
			Gui.FrmPO.GsGCPastDue.SetCellValue("gvPastDue",V.Local.iColumn,V.Args.RowIndex,V.Local.sOwner(0).Trim)
			
			F.ODBC.Connection!con.Execute(V.Local.sSQL)	
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPastDue_CellValueChanged.End

Program.Sub.optView_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",True)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",True)	
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optView_Click.End

Program.Sub.optEdit_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",False)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optEdit_Click.End

Program.Sub.optRecv_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","Email","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","Email","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","Email","ReadOnly",False)
	
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCAllPOs.SetColumnProperty("gvAllPOs","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCExpToday.SetColumnProperty("gvExpToday","CONF","ReadOnly",False)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","AllowEdit",True)
	Gui.FrmPO.GsGCPastDue.SetColumnProperty("gvPastDue","CONF","ReadOnly",False)
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.optRecv_Click.End

Program.Sub.CheckPOConF.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO2.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
	F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
		Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO2)
		F.Intrinsic.Control.If(V.Local.sPO2,=,V.Args.PO)
			Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","CONF",V.Local.iCnt,V.Args.Conf)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPOConF.End

Program.Sub.CheckNote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPO.Declare
	V.Local.sLine.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	F.Intrinsic.Control.If(V.Args.PO_Note,=,"NOTES")
		F.Intrinsic.Control.If(V.Args.GV,=,"gvAllPOs")
			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.ElseIf(V.Args.GV,=,"gvPastDue")
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.Else
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Args.PO_Note,=,"USER_5")
		F.Intrinsic.Control.If(V.Args.GV,=,"gvAllPOs")
			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.ElseIf(V.Args.GV,=,"gvPastDue")
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCExpToday.GetRowCount("gvExpToday",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCExpToday.GetCellValueByColumnName("gvExpToday","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCExpToday.SetCellValueByColumnName("gvExpToday","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.Else
			Gui.FrmPO.GsGCAllPOs.GetRowCount("gvAllPOs",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCAllPOs.GetCellValueByColumnName("gvAllPOs","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCAllPOs.SetCellValueByColumnName("gvAllPOs","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)

			Gui.FrmPO.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","PURCHASE_ORDER",V.Local.iCnt,V.Local.sPO)
				Gui.FrmPO.GsGCPastDue.GetCellValueByColumnName("gvPastDue","RECORD_NO",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sPO,=,V.Args.PO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmPO.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckNote.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bExists.Declare

	Gui.FrmPO.lbl1.Caption("Checking Database Table....")

	F.ODBC.Connection!con.TableExists("GAB_4163_PO_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_4163_PO_NOTES(PO CHAR(7),POLINE CHAR(3),NOTES LONGVARCHAR);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4163_PO_NOTES01 USING 1 ON GAB_4163_PO_NOTES(PO);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4163_PO_NOTES02 USING 2 ON GAB_4163_PO_NOTES(POLINE);")
	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!con.TableExists("GAB_PO_CONFCHK",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_PO_CONFCHK(PURCHASE_ORDER CHAR(7),CONF CHAR(1),GS_USER CHAR(8),DATE_CONF DATE);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_PO_CONFCHK00 ON GAB_PO_CONFCHK(PURCHASE_ORDER ASC);")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/login-customer","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.PrintAudit.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare

	F.Intrinsic.Control.If(V.Global.iDoNotPrintAudit,=,0)
		F.Global.General.CallWrapperSync(50,"PUR119GI")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.PrintAudit.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'GvAllPOs
	Gui.FrmPO.GsGCAllPOs.Serialize("gvAllPOs",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvExpToday
	Gui.FrmPO.GsGCExpToday.Serialize("gvExpToday",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvPastDue
	Gui.FrmPO.GsGCPastDue.Serialize("gvPastDue",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvOSV
	Gui.FrmPO.GsGCOSV.Serialize("gvOSV",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GvReqs
	Gui.FrmPO.GsGcReqs.Serialize("gvReqs",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVREQS",6300,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'Delete old registry records
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",6300,0,5,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
		F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 6300 And Seq < 1000;")
		F.ODBC.Connection!common.Close
	F.Intrinsic.Control.EndIf

	'GvAllPOs
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLPOS",6300,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCAllPOs.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvExpToday
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVEXPTODAY",6300,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCExpToday.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvPastDue
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6300,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCPastDue.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvOSV
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVOSV",6300,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGCOSV.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvReqs
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVREQS",6300,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
		Gui.FrmPO.GsGcReqs.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.cmdEmail_Click.Start
	V.Local.sError.Declare
	
	V.Local.sDT.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.iUserID.Declare
	V.Local.sSenderName.Declare
	V.Local.sSenderEmail.Declare
	V.Local.sParams.Declare
	V.Local.iBIRunID.Declare
	V.Local.iLogID.Declare
	V.Local.sAttach.Declare
	V.Local.sParamName.Declare
	V.Local.sParamVal.Declare
	V.Local.iRet.Declare
	V.Local.sRecipient.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	V.Local.sDir.Declare
	V.Local.bFile.Declare
	V.Local.sReportID.Declare(String)
	V.Local.sSql.Declare
	V.Local.sRet.Declare
	V.Local.sPrtOpenQtyOnly.Declare
	V.Local.sUseVendCurr.Declare
	V.Local.sPrtDueDateOnLines.Declare
	
	F.Intrinsic.Control.Try
	
		F.Intrinsic.Control.BlockEvents
	
		F.Intrinsic.Control.If(V.DataTable.dtEmails.Exists)
			F.Data.DataTable.Close("dtEmails")
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.String.Build("{0}\Orders",V.Caller.PluginsDir,V.Local.sDir)
		F.Intrinsic.File.CreateDir(V.Local.sDir)
	
		F.Intrinsic.Control.SelectCase(V.Screen.FrmPO!tabPODash.Tab)
			F.Intrinsic.Control.Case(0)
				V.Local.sDT.Set("dtAllPOs")
			F.Intrinsic.Control.Case(1)
				V.Local.sDT.Set("dtExpToday")
			F.Intrinsic.Control.Case(2)
				V.Local.sDT.Set("dtPastDue")
		F.Intrinsic.Control.EndSelect
		
		'Check Subject Txt File
		F.Intrinsic.String.Build("{0}\PPT_PU_Email_Subject_Custom.txt",V.Caller.FilesDir,V.Local.sSubject)
		F.Intrinsic.File.Exists(V.Local.sSubject,V.Local.bFile)
		F.Intrinsic.Control.If(V.Local.bFile,=,False)
			F.Intrinsic.String.Build("{0}\PPT_PU_Email_Subject.txt",V.Caller.FilesDir,V.Local.sSubject)
		F.Intrinsic.Control.EndIf
		
		'Check Body Txt File
		F.Intrinsic.String.Build("{0}\PPT_PU_Email_Body_Custom.txt",V.Caller.FilesDir,V.Local.sBody)
		F.Intrinsic.File.Exists(V.Local.sBody,V.Local.bFile)
		F.Intrinsic.Control.If(V.Local.bFile,=,False)
			F.Intrinsic.String.Build("{0}\PPT_PU_Email_Body.txt",V.Caller.FilesDir,V.Local.sBody)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create(V.Local.sDT,"dvEmails",22,"Email = True","")
		F.Data.DataView.ToDataTableDistinct(V.Local.sDT,"dvEmails","dtEmails","Purchase_Order*!*Vendor*!*Name_Vendor*!*Contact_Name*!*Contact_Email*!*Email",True)
		F.Data.DataView.Close(V.Local.sDT,"dvEmails")
		
		F.Data.DataTable.Select("dtEmails","Email = True",V.Local.sSelect)
		F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
			F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
			F.Global.Security.GetUserId(V.Caller.User,V.Caller.CompanyCode,V.Local.iUserID)
			F.Global.Security.GetFullName(V.Caller.User,V.Local.sSenderName)
			F.Global.Security.GetUserEmail(V.Caller.User,V.Local.sSenderEmail)
			F.Intrinsic.Control.If(V.Local.sSenderEmail,=,"")
				F.Intrinsic.UI.Msgbox("Error in email procedure. The GS User does not have an email address associated with it in User Security Maintenance.")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Screen.FrmPO!chkPrevEmls.Value,=,1)
				F.Intrinsic.Control.UnBlockEvents
				F.Data.Datatable.AddColumn("dtEmails","SenderName",String,V.Local.sSenderName)
				F.Data.Datatable.AddColumn("dtEmails","SenderEmail",String,V.Local.sSenderEmail)
				'Subject
				F.Intrinsic.File.File2String(V.Local.sSubject,V.Local.sSubject)
				'Body
				F.Intrinsic.File.File2String(V.Local.sBody,V.Local.sBody)
				'Modify DataTable
				F.Data.Datatable.AddColumn("dtEmails","Subject",String,V.Local.sSubject)
				F.Data.Datatable.AddColumn("dtEmails","Body",String,V.Local.sBody)
				F.Data.Datatable.AddColumn("dtEmails","AttachmentFiles",String)
				F.Data.Datatable.AddColumn("dtEmails","Attachments",Boolean,False)
				F.Data.Datatable.AddColumn("dtEmails","Preview",String,"Preview")
				F.Intrinsic.Control.CallSub(LoadPreviewEmails)
				F.Data.DataTable.SetValue("dtAllPOs",-1,"Email",False)
				F.Data.DataTable.SetValue("dtExpToday",-1,"Email",False)
				F.Data.DataTable.SetValue("dtPastDue",-1,"Email",False)
				Gui.FrmPO.lbl1.Visible(False)
				Gui.FrmPO.progressBar1.Visible(False)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
							
			Gui.FrmPO.lbl1.Caption("Get Options....")
			F.ODBC.Connection!con.ExecuteAndReturn("SELECT PKLST_AFT_SO AS PRT_OPEN_QTY_ONLY,LABELS_AFT_SO AS USE_VEND_CURR,STEEL_CALC AS PRT_DUE_DATE_ON_LINES FROM CUSTOM_RECORDS WHERE KEY1 = 'CMPRPT' AND KEY2 = 'OPT';",V.Local.sRet)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sPrtOpenQtyOnly.Set(V.Local.sRet(0))
			V.Local.sUseVendCurr.Set(V.Local.sRet(1))
			V.Local.sPrtDueDateOnLines.Set(V.Local.sRet(2))
			
			Gui.FrmPO.lbl1.Caption("Sending Emails....")
			Gui.FrmPO.lbl1.Visible(True)
			Gui.FrmPO.progressBar1.Visible(True)
			Gui.FrmPO.progressBar1.Min(0)
			F.Intrinsic.Control.If(V.Local.sSelect.UBound,<>,0)
				Gui.FrmPO.progressBar1.Max(V.Local.sSelect.UBound)
			F.Intrinsic.Control.Else
				Gui.FrmPO.progressBar1.Max(1)
			F.Intrinsic.Control.EndIf
							
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
				Gui.FrmPO.progressBar1.Value(V.Local.iCnt)
				F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Contact_Email!FieldValTrim,<>,"")
					'Populate BI Table
					' CW 915000 Print PO (PUR1LZ/I) - PO-NUM !*! SWITCH !*! SCRNLESS-HISTORY-FLAG !*! PRINT-OPEN-QTY-FLAG !*! USE-VENDOR-CUR-FLAG
					F.Intrinsic.String.Build("{0}!*!S!*!Y!*!{1}!*!{2}",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim,V.Local.sPrtOpenQtyOnly,V.Local.sUseVendCurr,V.Local.sParams)	
					F.Global.General.CallWrapperSyncBio(915000,V.Local.sParams)
					'Export File
					F.Global.BI.GetRunID(V.Local.iBIRunID)
					
					'Check to make sure callwrapper ran and updated table PRT_LASER_PO
					F.Intrinsic.Control.CallSub(verifyCallWrapperSuccessfullyRan, "sPurchaseOrderNumber", V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim)
					F.Intrinsic.Control.If(V.Args.bCallwrapperFailed)
						'If it failed, prompt user to let him/her know
						F.Intrinsic.String.Build("Unable to send email for Purchase Order {0}.", V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim, V.Local.sError)
						F.Intrinsic.UI.Msgbox(V.Local.sError)
					F.Intrinsic.Control.Else
						'Else prepare email for courier
						'Get Report ID
						'Check if the vendor has a custom report id associated to use it instead of default:2801
						F.Intrinsic.String.Build("SELECT BI_PO_RPT_ID FROM V_VENDOR_ADDL WHERE VENDOR = '{0}'",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Vendor!FieldValTrim,V.Local.sSql)
						F.Intrinsic.Control.If(V.DataTable.dtReportID.Exists)
							F.Data.DataTable.Close("dtReportID")
						F.Intrinsic.Control.EndIf
						F.Data.DataTable.CreateFromSQL("dtReportID","con",V.Local.sSql)
						F.Intrinsic.Control.If(V.DataTable.dtReportID.RowCount,>,0)					
							F.Intrinsic.Control.If(V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim,=,V.Ambient.Null,or,V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim,=,"000000")
								'Set the default report id 
								V.Local.sReportID.Set("002801")
							F.Intrinsic.Control.Else	
								'Set the custom report id for the vendor
								V.Local.sReportID.Set(V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Global.BI.StartLogging(V.Local.iBIRunID,V.Local.sReportID,-1,"",V.Local.iLogID)
						F.Intrinsic.String.Build("{0}\Orders\{1}.pdf",V.Caller.PluginsDir,V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim,V.Local.sAttach)
						V.Local.sParamName.Set("Terminal*!*ReportID*!*UseVendorCurr*!*PRTCNFRM*!*PROGRAM*!*PRTHIST*!*QTYDEC")
						F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!* *!* *!* *!*0*!* *!*",V.Caller.Terminal,V.Local.sReportID,V.Local.sUseVendCurr,V.Local.sParamVal)
						F.Global.BI.RunReportPreProcessor(V.Local.iBIRUNID,V.Local.iLogID,V.Local.sParamName,V.Local.sParamVal,"",4,True,"",-1,"",0,V.Local.sAttach,"",V.Local.iRet)
						F.Global.BI.StopLogging(V.Local.iLogID)
						'Prepare Email
						F.Intrinsic.String.Build("{0}*!*{0}",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Contact_Email!FieldValTrim,V.Local.sRecipient)
						F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sSenderEmail,V.Local.sSenderName,V.Local.sSenderEmail)
						F.Intrinsic.String.Build("{0}.pdf*!*{1}\Orders\",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim,V.Caller.PluginsDir,V.Local.sAttach)
						'Subject
						F.Intrinsic.String.Build("{0}\GCG_6300_Email_Subject.txt",V.Caller.FilesDir,V.Local.sSubject)
						F.Intrinsic.File.File2String(V.Local.sSubject,V.Local.sSubject)
						F.Intrinsic.String.Replace(V.Local.sSubject,"%PO%",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim,V.Local.sSubject)
						'Body
						F.Intrinsic.String.Build("{0}\GCG_6300_Email_Body.txt",V.Caller.FilesDir,V.Local.sBody)
						F.Intrinsic.File.File2String(V.Local.sBody,V.Local.sBody)
						F.Intrinsic.String.Replace(V.Local.sBody,"%PO%",V.DataTable.dtEmails(V.Local.sSelect(V.Local.iCnt)).Purchase_Order!FieldValTrim,V.Local.sBody)
						F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.Local.sSenderName,V.Local.sBody)
						'Send Email				
						F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,0,"",V.Local.sSubject,V.Local.sSenderEmail,V.Local.sRecipient,V.Local.sBody,5,"",False,"","","","","","","",V.Local.sAttach,False)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.SetValue("dtAllPOs",-1,"Email",False)
		F.Data.DataTable.SetValue("dtExpToday",-1,"Email",False)
		F.Data.DataTable.SetValue("dtPastDue",-1,"Email",False)
		Gui.FrmPO.lbl1.Visible(False)
		Gui.FrmPO.progressBar1.Visible(False)
		
		F.Intrinsic.Control.UnBlockEvents

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdEmail_Click.End

Program.Sub.verifyCallWrapperSuccessfullyRan.Start
	V.Local.sSQL.Declare(String)
	V.Local.sError.Declare(string)
	V.Local.sReportID.Declare(string)
	
	F.Intrinsic.Control.Try
		'delete rows for current terminal that are not for the same PO
		F.Intrinsic.String.Build("Delete from PRT_LASER_PO where TERMINAL_NO='{0}' and PO_NO<>'{1}'",V.Caller.Terminal,V.Args.sPurchaseOrderNumber,V.Local.sSQL)
		F.ODBC.Connection!con.Execute(V.Local.sSQL)
		
		'Check that data exists in the table
		Function.Intrinsic.String.Build("Select DISTINCT RPTID from PRT_LASER_PO where TERMINAL_NO = '{0}'",V.Caller.Terminal,V.Local.sSql)
		F.ODBC.Connection!con.Executeandreturn(V.Local.sSql,V.Local.sReportID)
		F.Intrinsic.Control.If(V.Ambient.executeandreturneoF.not)
			Function.Intrinsic.Variable.AddRV("bCallwrapperFailed",False)
		Function.Intrinsic.Control.Else
			'Could not find BI data, this is a sign that callwrapper failed
			Function.Intrinsic.Variable.AddRV("bCallwrapperFailed", True)
		Function.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.verifyCallWrapperSuccessfullyRan.End

Program.Sub.chkPrevEmls_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Screen.FrmPO!chkPrevEmls.Value,=,1)
		F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",6300,2000,False,"Preview Emails",True,0,-999.0,1/1/1980,12:00:00 AM)
	F.Intrinsic.Control.Else
		F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",6300,2000,False,"Preview Emails",False,0,-999.0,1/1/1980,12:00:00 AM)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.chkPrevEmls_Click.End

Program.Sub.frmPrevEmail_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmPrevEmail..Visible(False)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmPrevEmail_UnLoad.End

Program.Sub.LoadPreviewEmails.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmPrevEmail.GsGCPrevEml.AddGridviewFromDatatable("gvEmails","dtEmails")
	Gui.frmPrevEmail.GsGCPrevEml.SuspendLayout()
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","MultiSelect",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","AllowSort",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","AllowFilter",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","Editable",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","ReadOnly",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","ShowGroupPanel",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","Enableappearanceoddrow",True)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","Visible",False)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","ShowCaption",False)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","Caption","PO")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","Caption","Vendor")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","Caption","Name")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","Caption","Email")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","Caption","Send Email")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","Caption","Sender Name")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","Caption","Sender Email")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","Caption","Subject")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","Caption","Body")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","Caption","Files")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","Caption","Attachments")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","Caption","Preview")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","MinWidth","85")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","HeaderFontBold",True)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","HeaderHAlignment","Center")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Email","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellHAlignment","Center")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellBackColor","Gray")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellForeColor","White")
	
	Gui.frmPrevEmail.GsGCPrevEml.ResumeLayout()
	Gui.frmPrevEmail.GsGCPrevEml.MainView("gvEmails")
	
	Gui.frmPrevEmail..Show

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadPreviewEmails.End

Program.Sub.GsGCPrevEml_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilePath.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Preview")
			Gui.frmEmail..Caption("Edit Email")
			Gui.frmEmail.txtSName.Text(V.DataTable.dtEmails(V.Args.RowIndex).SenderName!FieldValTrim)
			Gui.frmEmail.txtSEmail.Text(V.DataTable.dtEmails(V.Args.RowIndex).SenderEmail!FieldValTrim)
			Gui.frmEmail.txtRName.Text(V.DataTable.dtEmails(V.Args.RowIndex).Contact_Name!FieldValTrim)
			Gui.frmEmail.txtREmail.Text(V.DataTable.dtEmails(V.Args.RowIndex).Contact_Email!FieldValTrim)
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Args.RowIndex).Subject!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Args.RowIndex).Purchase_Order!FieldValTrim,V.Local.sSubject)
			Gui.frmEmail.txtSubject.Text(V.Local.sSubject)
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Args.RowIndex).Body!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Args.RowIndex).Purchase_Order!FieldValTrim,V.Local.sBody)
			F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.DataTable.dtEmails(V.Args.RowIndex).SenderName!FieldValTrim,V.Local.sBody)
			Gui.frmEmail.txtBody.Text(V.Local.sBody)
			Gui.frmEmail.txtAttach.Text(V.DataTable.dtEmails(V.Args.RowIndex).AttachmentFiles!FieldValTrim)
			Gui.frmEmail.txtRow.Text(V.Args.RowIndex)
			Gui.frmEmail..Show
			Gui.frmEmail.txtSName.SetFocus
	F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPrevEml_RowCellClick.End

Program.Sub.cmdSend_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sSender.Declare
	V.Local.sRecipient.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	V.Local.sAttachments.Declare
	V.Local.sFiles.Declare
	V.Local.sFilePath.Declare
	V.Local.sFileName.Declare
	V.Local.sParams.Declare
	V.Local.iBIRunID.Declare
	V.Local.iLogID.Declare
	V.Local.sParamName.Declare
	V.Local.sParamVal.Declare
	V.Local.iRet.Declare
	V.Local.sSQL.Declare
	V.Local.sReportID.Declare(String)
	V.Local.sRet.Declare
	V.Local.sPrtOpenQtyOnly.Declare
	V.Local.sUseVendCurr.Declare
	V.Local.sPrtDueDateOnLines.Declare
	
	F.Intrinsic.Control.BlockEvents
	
	Gui.frmPrevEmail.lblStatus.Visible(True)
	Gui.frmPrevEmail.pbStatus.Visible(True)
	Gui.frmPrevEmail.pbStatus.Min(0)
	F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,<>,0)
		Gui.frmPrevEmail.pbStatus.Max(V.DataTable.dtEmails.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPrevEmail.pbStatus.Max(100)
	F.Intrinsic.Control.EndIf
	
	'Gui.frmPrevEmail.lblStatus.Caption("Get Options....")
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT PKLST_AFT_SO AS PRT_OPEN_QTY_ONLY,LABELS_AFT_SO AS USE_VEND_CURR,STEEL_CALC AS PRT_DUE_DATE_ON_LINES FROM CUSTOM_RECORDS WHERE KEY1 = 'CMPRPT' AND KEY2 = 'OPT';",V.Local.sRet)
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	V.Local.sPrtOpenQtyOnly.Set(V.Local.sRet(0))
	V.Local.sUseVendCurr.Set(V.Local.sRet(1))
	V.Local.sPrtDueDateOnLines.Set(V.Local.sRet(2))
		
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtEmails.RowCount--,1)
		Gui.frmPrevEmail.pbStatus.Value(V.Local.iCnt)
		F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,<>,"")
			'Populate BI Table
			'F.Intrinsic.String.Build("{0}!*!S!*! !*!N!*!N",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sParams)	
			
			'Populate BI Table
			' CW 915000 Print PO (PUR1LZ/I) - PO-NUM !*! SWITCH !*! SCRNLESS-HISTORY-FLAG !*! PRINT-OPEN-QTY-FLAG !*! USE-VENDOR-CUR-FLAG
			F.Intrinsic.String.Build("{0}!*!S!*!Y!*!{1}!*!{2}",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sPrtOpenQtyOnly,V.Local.sUseVendCurr,V.Local.sParams)	
			F.Global.General.CallWrapperSyncBio(915000,V.Local.sParams)
			'Export File
			F.Global.BI.GetRunID(V.Local.iBIRunID)
			'Get Report ID
			'Check if the vendor has a custom report id associated to use it instead of default:2801
			F.Intrinsic.String.Build("SELECT BI_PO_RPT_ID FROM V_VENDOR_ADDL WHERE VENDOR = '{0}'",V.DataTable.dtEmails(V.Local.iCnt).Vendor!FieldValTrim,V.Local.sSql)
			F.Intrinsic.Control.If(V.DataTable.dtReportID.Exists)
					F.Data.DataTable.Close("dtReportID")
				F.Intrinsic.Control.EndIf
			F.Data.DataTable.CreateFromSQL("dtReportID","con",V.Local.sSQL)
			F.Intrinsic.Control.If(V.DataTable.dtReportID.RowCount,>,0)					
				F.Intrinsic.Control.If(V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim,=,V.Ambient.Null,or,V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim,=,"000000",V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim,=,"0")
					'Set the default report id 
					V.Local.sReportID.Set("002801")
				F.Intrinsic.Control.Else	
					'Set the custom report id for the vendor
					V.Local.sReportID.Set(V.DataTable.dtReportID(0).BI_PO_RPT_ID!FieldValTrim)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'F.Global.BI.StartLogging(V.Local.iBIRunID,002801,-1,"",V.Local.iLogID)
			F.Global.BI.StartLogging(V.Local.iBIRunID,V.Local.sReportID,-1,"",V.Local.iLogID)
			F.Intrinsic.String.Build("{0}\Orders\{1}.pdf",V.Caller.PluginsDir,V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sAttachments)
			V.Local.sParamName.Set("Terminal*!*ReportID*!*UseVendorCurr*!*PRTCNFRM*!*PROGRAM*!*PRTHIST*!*QTYDEC")			
			F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!* *!* *!* *!*0*!* *!*",V.Caller.Terminal,V.Local.sReportID,V.Local.sUseVendCurr,V.Local.sParamVal)
			F.Global.BI.RunReportPreProcessor(V.Local.iBIRUNID,V.Local.iLogID,V.Local.sParamName,V.Local.sParamVal,"",4,True,"",-1,"",0,V.Local.sAttachments,"",V.Local.iRet)
			F.Global.BI.StopLogging(V.Local.iLogID)
			'Recipient
			F.Intrinsic.String.Build("{0}*!*{1}",V.DataTable.dtEmails(V.Local.iCnt).Contact_Name!FieldValTrim,V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,V.Local.sRecipient)
			'Sender
			F.Intrinsic.String.Build("{0}*!*{1}",V.DataTable.dtEmails(V.Local.iCnt).SenderEmail!FieldValTrim,V.DataTable.dtEmails(V.Local.iCnt).SenderName!FieldValTrim,V.Local.sSender)
			'PO Attachments
			F.Intrinsic.String.Build("{0}.pdf*!*{1}\Orders\",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Caller.PluginsDir,V.Local.sAttachments)
			'Additional Attachments
			F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.iCnt).Attachments!FieldVal)
				F.Intrinsic.String.Split(V.DataTable.dtEmails(V.Local.iCnt).AttachmentFiles!FieldVal,V.Ambient.NewLine,V.Local.sFiles)
				F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sFiles.UBound,1)
					F.Intrinsic.String.Split(V.Local.sFiles(V.Local.iCnt2),"\",V.Local.sFileName)
					V.Local.sFileName.Set(V.Local.sFileName(V.Local.sFileName.UBound))
					F.Intrinsic.String.Replace(V.Local.sFiles(V.Local.iCnt2),V.Local.sFileName,"",V.Local.sFilePath)
					F.Intrinsic.String.Build("{0}@!@{1}*!*{2}",V.Local.sAttachments,V.Local.sFileName,V.Local.sFilePath,V.Local.sAttachments)
				F.Intrinsic.Control.Next(V.Local.iCnt2)
			F.Intrinsic.Control.EndIf
			'Subject
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Subject!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sSubject)
			'Body
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Body!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sBody)
			F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.DataTable.dtEmails(V.Local.iCnt).SenderName!FieldValTrim,V.Local.sBody)
			'Send Email				
			F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,0,"",V.Local.sSubject,V.Local.sSender,V.Local.sRecipient,V.Local.sBody,5,"",False,"","","","","","","",V.Local.sAttachments,False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,<>,0)
		Gui.frmPrevEmail.pbStatus.Value(V.DataTable.dtEmails.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPrevEmail.pbStatus.Value(100)
	F.Intrinsic.Control.EndIf
	
	Gui.frmPrevEmail.lblStatus.Visible(False)
	Gui.frmPrevEmail.pbStatus.Visible(False)
	F.Intrinsic.Control.CallSub(frmPrevEmail_UnLoad)
	
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSend_Click.End

Program.Sub.frmEmail_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmEmail_UnLoad.End

Program.Sub.cmdSavePreview_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sAttach.Declare
	V.Local.bAttach.Declare
	
	V.Local.sAttach.Set(V.Screen.frmEmail!txtAttach.Text)
	F.Intrinsic.Control.If(V.Local.sAttach.Trim,<>,"")
		V.Local.bAttach.Set(True)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtEmails",V.Screen.frmEmail!txtRow.Text,"SenderName",V.Screen.frmEmail!txtSName.Text,"SenderEmail",V.Screen.frmEmail!txtSEmail.Text,"Contact_Name",V.Screen.frmEmail!txtRName.Text,"Contact_Email",V.Screen.frmEmail!txtREmail.Text,"Subject",V.Screen.frmEmail!txtSubject.Text,"Body",V.Screen.frmEmail!txtBody.Text,"AttachmentFiles",V.Screen.frmEmail!txtAttach.Text,"Attachments",V.Local.bAttach)
	Gui.frmEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSavePreview_Click.End

Program.Sub.DragDrop.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iCnt.Declare
	V.Local.sFiles.Declare
	V.Local.sAttach.Declare
	
	F.Intrinsic.String.Split(V.Args.Files,"*!*",V.Local.sFiles)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sFiles.UBound,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			V.Local.sAttach.Set(V.Local.sFiles(V.Local.iCnt))
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sAttach,V.Ambient.NewLine,V.Local.sFiles(V.Local.iCnt),V.Local.sAttach)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.String.Build("{0}{1}",V.Screen.frmEmail!txtAttach.Text,V.Local.sAttach,V.Local.sAttach)
	Gui.frmEmail.txtAttach.Text(V.Local.sAttach)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.DragDrop.End

Program.Sub.ImpactData.Start
'6300
F.Intrinsic.Control.Try
V.Local.sError.Declare
V.Local.sSQL.Declare
V.Local.iCnt.Declare
V.Local.iItem.Declare
V.Local.sPO.Declare
V.Local.sLine.Declare

V.Local.sPO.Set(V.Args.PO)
V.Local.sLine.Set(V.Args.Line)

Gui.fmImpact.txtCtrlName.Text(V.Args.CtrlName)
Gui.fmImpact.txtRowIndex.Text(V.Args.sRowIndex)

F.Intrinsic.String.Build("{0}-{1}",V.Local.sPO.Trim,V.Local.sLine.Trim,V.Local.sPO)

Gui.fmImpact.lblPONum.Caption(V.Local.sPO)

F.ODBC.Connection!comm.OpenCommonConnection
F.Intrinsic.String.Build("Select GS_USER,RTRIM(GS_USER)+' | '+RTRIM(FIRST_NAME) from USER_INFORMATION where COMPANY = '{0}' or COMPANY = '' order by GS_USER",V.Caller.CompanyCode,V.Local.sSQL)
F.Data.Dictionary.CreateFromSQL("dictUsers","comm",V.Local.sSQL)
F.ODBC.Connection!comm.Close

Gui.fmImpact.ddlUImpOwn.ClearItems
Gui.fmImpact.ddlUImpOwn.AddItem(" ",0)
Gui.fmImpact.ddlUImpOwn.AddItems("Dictionary","dictUsers")
F.Data.Dictionary.Close("dictUsers")

F.ODBC.Connection!conts.OpenCompanyConnection

F.ODBC.Connection!conts.ExecuteAndReturn("Select DDL_VALUE from GCG_6300_MX where TYPE = 'PO' and RTRIM(DDL_TYPE) = 'REASON'",V.Local.sSQL)
F.Intrinsic.String.Split(V.Local.sSQL,"#$#",V.Local.sSQL)

Gui.fmImpact.ddlImpReason.ClearItems
Gui.fmImpact.ddlImpReason.AddItem(" ",0)

F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSQL.LBound,V.Local.sSQL.UBound,1)
	F.Intrinsic.Math.Add(V.Local.iCnt,1,V.Local.iItem)
	Gui.fmImpact.ddlImpReason.AddItem(V.Local.sSQL(V.Local.iCnt),V.Local.iItem)
F.Intrinsic.Control.Next(V.Local.iCnt)

V.Local.sSQL.Redim(0,0)

F.ODBC.Connection!conts.ExecuteAndReturn("Select DDL_VALUE from GCG_6300_MX where TYPE = 'PO' and RTRIM(DDL_TYPE) = 'DEPT OWNER'",V.Local.sSQL)
F.Intrinsic.String.Split(V.Local.sSQL,"#$#",V.Local.sSQL)

Gui.fmImpact.ddlDImpOwn.ClearItems
Gui.fmImpact.ddlDImpOwn.AddItem(" ",0)

F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSQL.LBound,V.Local.sSQL.UBound,1)
	F.Intrinsic.Math.Add(V.Local.iCnt,1,V.Local.iItem)
	Gui.fmImpact.ddlDImpOwn.AddItem(V.Local.sSQL(V.Local.iCnt),V.Local.iItem)
F.Intrinsic.Control.Next(V.Local.iCnt)

V.Local.sSQL.Redim(0,0)

F.Intrinsic.String.Build("Select * from GCG_6300_IMPACTS where CNTRL_NUM = '{0}' and CNTRL_SUF_LN = '{1}' or CNTRL_NUM = '{0}' and CNTRL_SUF_LN is null;",V.Args.PO.Trim,V.Args.Line.Trim,V.Local.sSQL)
F.Data.Datatable.CreateFromSQL("dtImpacts","conts",V.Local.sSQL)

F.ODBC.Connection!conts.Close

Gui.fmImpact.GsGcImpact.SuspendLayout

Gui.fmImpact.GsGcImpact.AddGridviewFromDatatable("gvImpacts","dtImpacts")
Gui.fmImpact.GsGcImpact.MainView("gvImpacts")

Gui.fmImpact.GsGcImpact.SetGridviewProperty("gvImpacts","EnableAppearanceOddRow",True)

'Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","PO_TYPE","Visible",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","CNTRL_NUM","Visible",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","CNTRL_SUF_LN","Visible",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RECORD_NO","Visible",False)

'Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","PO_TYPE","AllowShowHide",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","CNTRL_NUM","AllowShowHide",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","CNTRL_SUF_LN","AllowShowHide",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RECORD_NO","AllowShowHide",False)

Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_IMPACT","Caption","Impact Date")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT_REASON","Caption","Impact Reason")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DEPT_IMP_OWNER","Caption","Dept Impact Owner")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_IMP_OWNER","Caption","User Imact Owner")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT","Caption","Impact")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","NEXT_STEP","Caption","Next Step")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RESOLUTION","Caption","Resolution")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_CLOSED","Caption","Date Closed")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_CLOSED","Caption","User Closed")

Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_IMPACT","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT_REASON","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DEPT_IMP_OWNER","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_IMP_OWNER","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","NEXT_STEP","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RESOLUTION","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_CLOSED","HeaderFontBold",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_CLOSED","HeaderFontBold",True)

Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_IMPACT","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT_REASON","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DEPT_IMP_OWNER","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_IMP_OWNER","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","NEXT_STEP","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RESOLUTION","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_CLOSED","ReadOnly",True)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_CLOSED","ReadOnly",True)

Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_IMPACT","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT_REASON","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DEPT_IMP_OWNER","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_IMP_OWNER","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","IMPACT","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","NEXT_STEP","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","RESOLUTION","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_CLOSED","AllowEdit",False)
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","USER_CLOSED","AllowEdit",False)

Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_IMPACT","DisplayCustomDateTime","d")
Gui.fmImpact.GsGcImpact.SetColumnProperty("gvImpacts","DATE_CLOSED","DisplayCustomDateTime","d")

Gui.fmImpact.GsGcImpact.ResumeLayout

Gui.fmImpact..Show

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.ImpactData.End

Program.Sub.GsGcImpact_RowCellClick.Start
'6300
F.Intrinsic.Control.Try
V.Local.sError.Declare

V.Local.iRecNum.Declare
V.Local.sImpRsn.Declare
V.Local.sDeptImpOwn.Declare
V.Local.sUserImpOwn.Declare
V.Local.sImpact.Declare
V.Local.sNextStep.Declare
V.Local.sRes.Declare
V.Local.dCloseDate.Declare
V.Local.sSQL.Declare

Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","RECORD_NO",V.Args.RowIndex,V.Local.iRecNum)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","IMPACT_REASON",V.Args.RowIndex,V.Local.sImpRsn)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","DEPT_IMP_OWNER",V.Args.RowIndex,V.Local.sDeptImpOwn)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","USER_IMP_OWNER",V.Args.RowIndex,V.Local.sUserImpOwn)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","IMPACT",V.Args.RowIndex,V.Local.sImpact)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","NEXT_STEP",V.Args.RowIndex,V.Local.sNextStep)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","RESOLUTION",V.Args.RowIndex,V.Local.sRes)
Gui.fmImpact.GsGcImpact.GetCellValueByColumnName("gvImpacts","DATE_CLOSED",V.Args.RowIndex,V.Local.dCloseDate)

F.ODBC.Connection!comm.OpenCommonConnection
	F.Intrinsic.String.Build("Select RTRIM(GS_USER)+' | '+RTRIM(FIRST_NAME) from USER_INFORMATION where GS_USER = '{0}'",V.Local.sUserImpOwn.Trim,V.Local.sSQL)
	F.ODBC.Connection!comm.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
F.ODBC.Connection!comm.Close

Gui.fmImpact.txtRecord.Text(V.Local.iRecNum)
Gui.fmImpact.ddlImpReason.Text(V.Local.sImpRsn.Trim)
Gui.fmImpact.ddlDImpOwn.Text(V.Local.sDeptImpOwn.Trim)
Gui.fmImpact.ddlUImpOwn.Text(V.Local.sSQL.Trim)
Gui.fmImpact.txtImpact.Text(V.Local.sImpact.Trim)
Gui.fmImpact.txtNextStep.Text(V.Local.sNextStep)
Gui.fmImpact.txtRes.Text(V.Local.sRes.Trim)
Gui.fmImpact.dtpClsDate.Value(V.Local.dCloseDate)

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.GsGcImpact_RowCellClick.End

Program.Sub.cmdSv_Click.Start
'6300
F.Intrinsic.Control.Try
V.Local.sError.Declare

V.Local.sPO.Declare
V.Local.iRecNum.Declare
V.Local.sCntrlNum.Declare
V.Local.sCntrlSufLn.Declare
V.Local.sImpRsn.Declare
V.Local.sDeptImpOwn.Declare
V.Local.sUserImpOwn.Declare
V.Local.sImpact.Declare
V.Local.sNextStep.Declare
V.Local.sRes.Declare
V.Local.dCloseDate.Declare
V.Local.sSQL.Declare
V.Local.sUserChk.Declare
V.Local.sCtrlName.Declare
V.Local.sRowIndex.Declare
V.Local.sGV.Declare
V.Local.iColumn.Declare

V.Local.sCtrlName.Set(V.Screen.fmImpact!txtCtrlName.Text)
V.Local.sRowIndex.Set(V.Screen.fmImpact!txtRowIndex.Text)

F.Intrinsic.Control.If(V.Local.sCtrlName.Trim,=,"GSGCALLPOS")
	V.Local.sGV.Set("gvAllPOs")
F.Intrinsic.Control.ElseIf(V.Local.sCtrlName.Trim,=,"GSGCEXPTODAY")
	V.Local.sGV.Set("gvExpToday")
F.Intrinsic.Control.Else
	V.Local.sGV.Set("gvPastDue")
F.Intrinsic.Control.EndIf

V.Local.sPO.Set(V.Screen.fmImpact!lblPONum.Caption)

F.Intrinsic.String.Split(V.Local.sPO,"-",V.Local.sPO)

V.Local.iRecNum.Set(V.Screen.fmImpact!txtRecord.Text.Trim)
V.Local.sCntrlNum.Set(V.Local.sPO(0).Trim)
V.Local.sCntrlSufLn.Set(V.Local.sPO(1).Trim)

V.Local.sImpRsn.Set(V.Screen.fmImpact!ddlImpReason.Text.Trim)
V.Local.sDeptImpOwn.Set(V.Screen.fmImpact!ddlDImpOwn.Text.Trim)
V.Local.sUserImpOwn.Set(V.Screen.fmImpact!ddlUImpOwn.Text.Trim)
V.Local.sImpact.Set(V.Screen.fmImpact!txtImpact.Text.Trim)
V.Local.sNextStep.Set(V.Screen.fmImpact!txtNextStep.Text.Trim)
V.Local.sRes.Set(V.Screen.fmImpact!txtRes.Text.Trim)
V.Local.dCloseDate.Set(V.Screen.fmImpact!dtpClsDate.Text)

F.Intrinsic.Control.If(V.Local.sImpRsn.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Please select an impact reason","Error")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sDeptImpOwn.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Please select a department impact owner","Error")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sUserImpOwn.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Please select a user impact owner","Error")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sImpact.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Please enter an impact","Error")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Right(V.Local.sUserImpOwn.Trim,1,V.Local.sUserChk)

F.Intrinsic.Control.If(V.Local.sUserChk.Trim,=,"|")
	F.Intrinsic.String.Split(V.Local.sUserImpOwn.Trim," |",V.Local.sUserImpOwn)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Split(V.Local.sUserImpOwn.Trim," | ",V.Local.sUserImpOwn)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!conts.OpenCompanyConnection

F.Intrinsic.String.Build("Select * from GCG_6300_IMPACTS where RECORD_NO = '{0}'",V.Local.iRecNum,V.Local.sSQL)
F.ODBC.Connection!conts.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)

F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.dCloseDate.PervasiveDate,=,"1900-01-01")
		F.Intrinsic.String.Build("Insert into GCG_6300_IMPACTS (TYPE,CNTRL_NUM,CNTRL_SUF_LN,DATE_IMPACT,IMPACT_REASON,DEPT_IMP_OWNER,USER_IMP_OWNER,IMPACT,NEXT_STEP,RESOLUTION,DATE_CLOSED) values('{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}','{9}','{10}')","PO",V.Local.sCntrlNum.Trim,V.Local.sCntrlSufLn.Trim,V.Ambient.Date.PervasiveDate,V.Local.sImpRsn.Trim,V.Local.sDeptImpOwn.Trim,V.Local.sUserImpOwn(0).Trim,V.Local.sImpact.Trim,V.Local.sNextStep.Trim,V.Local.sRes.Trim,"1900-01-01",V.Local.sSQL)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Insert into GCG_6300_IMPACTS (TYPE,CNTRL_NUM,CNTRL_SUF_LN,DATE_IMPACT,IMPACT_REASON,DEPT_IMP_OWNER,USER_IMP_OWNER,IMPACT,NEXT_STEP,RESOLUTION,DATE_CLOSED,USER_CLOSED) values('{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}','{9}','{10}','{11}')","WO",V.Local.sCntrlNum.Trim,V.Local.sCntrlSufLn.Trim,V.Ambient.Date.PervasiveDate,V.Local.sImpRsn.Trim,V.Local.sDeptImpOwn.Trim,V.Local.sUserImpOwn(0).Trim,V.Local.sImpact.Trim,V.Local.sNextStep.Trim,V.Local.sRes.Trim,V.Local.dCloseDate.PervasiveDate,V.Caller.User,V.Local.sSQL)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.dCloseDate.PervasiveDate,=,"1900-01-01")
		F.Intrinsic.String.Build("Update GCG_6300_IMPACTS set IMPACT_REASON = '{0}',DEPT_IMP_OWNER = '{1}',USER_IMP_OWNER = '{2}',IMPACT = '{3}',NEXT_STEP = '{4}',RESOLUTION = '{5}' where RECORD_NO = '{6}'",V.Local.sImpRsn.Trim,V.Local.sDeptImpOwn.Trim,V.Local.sUserImpOwn(0).Trim,V.Local.sImpact.Trim,V.Local.sNextStep.Trim,V.Local.sRes.Trim,V.Local.iRecNum,V.Local.sSQL)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Update GCG_6300_IMPACTS set IMPACT_REASON = '{0}',DEPT_IMP_OWNER = '{1}',USER_IMP_OWNER = '{2}',IMPACT = '{3}',NEXT_STEP = '{4}',RESOLUTION = '{5}',DATE_CLOSED = '{6}',USER_CLOSED = '{7}' where RECORD_NO = '{8}'",V.Local.sImpRsn.Trim,V.Local.sDeptImpOwn.Trim,V.Local.sUserImpOwn(0).Trim,V.Local.sImpact.Trim,V.Local.sNextStep.Trim,V.Local.sRes.Trim,V.Local.dCloseDate.PervasiveDate,V.Caller.User,V.Local.iRecNum,V.Local.sSQL)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Connection!conts.Execute(V.Local.sSQL)

F.ODBC.Connection!conts.Close

Gui.FrmPO.[V.Local.sCtrlName].GetColumnIndexByName(V.Local.sGV,"IMPACT",V.Local.iColumn)

Gui.FrmPO.[V.Local.sCtrlName].SetCellAppearance(V.Local.sGV,V.Local.iColumn,V.Local.sRowIndex,"BackColor",V.Enum.ThemeColors!ColorRed)

F.Intrinsic.Control.CallSub(cmdClr_Click)

F.Intrinsic.Control.CallSub(ImpactData,"PO",V.Local.sCntrlNum.Trim,"Line",V.Local.sCntrlSufLn.Trim,"CtrlName",V.Local.sCtrlName,"sRowIndex",V.Local.sRowIndex)

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.cmdSv_Click.End

Program.Sub.cmdClr_Click.Start
'6300
F.Intrinsic.Control.Try
V.Local.sError.Declare

Gui.fmImpact.txtRecord.Text("")
Gui.fmImpact.ddlImpReason.ClearSelected
Gui.fmImpact.ddlDImpOwn.ClearSelected
Gui.fmImpact.ddlUImpOwn.ClearSelected
Gui.fmImpact.txtImpact.Text("")
Gui.fmImpact.txtNextStep.Text("")
Gui.fmImpact.txtRes.Text("")
Gui.fmImpact.dtpClsDate.Value("1/1/1900")

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.cmdClr_Click.End

Program.Sub.fmImpact_UnLoad.Start
F.Intrinsic.Control.CallSub(cmdClr_Click)
Gui.fmImpact..Visible(False)
Program.Sub.fmImpact_UnLoad.End

Program.Sub.Comments.Start
${$0$}$GAB_4163_PU_PurchaseReview_POConf$}$Joey T & AGV$}$5/17/2016 10:18:54 AM$}$False
${$3$}$0$}$$}$0$}$-1$}$$}$12:00:00 AM$}$Tables:
${$5$}$2.0.0.0$}$2
${$6$}$sstanka$}$20210722110631801$}$mP+zz5Tw3sT2/nyap+FbWm4triMPqjXDelq42xSdLjPkLq4tlzVyUipm4XhUUKQumqJT58QgOzs=
Program.Sub.Comments.End